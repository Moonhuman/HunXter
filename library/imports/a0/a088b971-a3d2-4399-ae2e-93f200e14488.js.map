{"version":3,"sources":["assets\\scripts\\Cell.js"],"names":["cc","Class","Component","properties","mapx","mapy","kind","inMonitor","routeID","setColor","node","color","Color","RED","resetColor","stepOnCell","person","person_js","getComponent","game","emit","cardName","rand_val","Math","random","totCardNum","cardID","floor","console","log","cards","push","note","Node","addComponent","Sprite","setPosition","parent","self","loader","loadRes","SpriteFrame","err","spriteFrame","on","event","destroy","rand_event","event_name","useCardEnabled","goEnabled","blood","turn","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\t\tmapx: 0, //在map[i][j]中的横坐标\n\t\tmapy: 0,//在map[i][j]中的纵坐标\n\t\tkind: null, //格子的类型，0:空白格，1:卡牌格，2:事件格\n\t\tinMonitor: 0, //用来判断是否处于监听中的标记\n\t\trouteID: null, //记录这个cell是map中哪条route的终点，即在routes中的下标\n\t\t\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\t\n\tsetColor: function() {\n\t\t//设置cell的颜色为红色，表示可走\n\t\tthis.node.color = cc.Color.RED;\n\t},\n\t\n\tresetColor: function() {\n\t\t//还原cell的颜色\n\t\tthis.node.color = cc.color(255,255,255,255);\n\t},\n\t\n\tstepOnCell: function(person) {\n\t\t\n\t\t//获取person节点的组件\n\t\tvar person_js = person.getComponent('Person');\n\t\t\n\t\tif (this.kind == 0) {//空白格\n\t\t\tcc.game.emit('stepOnCell-done');\n\t\t\treturn;\n\t\t}\n\t\telse if (this.kind == 1) {//卡牌格\n\t\t\tvar cardName = ['炸弹','精准导弹','地雷','庇护','天使的庇护','战神的祝福','虚弱','团队的力量',\n\t\t\t\t\t\t\t'治愈','圣光普照','望远镜','眼睛','猛男的祝福','盗取','束缚','迷惑','拯救'];\n\t\t\tvar rand_val = Math.random();\n\t\t\tif (rand_val < 0.5) {\n\t\t\t\t//随机获得1张牌\n\t\t\t\tvar totCardNum = 17\n\t\t\t\tvar cardID = Math.floor(Math.random()*totCardNum);\n\t\t\t\tconsole.log(cardID);\n\t\t\t\tperson_js.cards.push(cardID);\n\t\t\t\t\n\t\t\t\t//创建用来提示获得卡牌的精灵节点\n\t\t\t\tvar note = new cc.Node();\n\t\t\t\tnote.addComponent(cc.Sprite);\n\t\t\t\tnote.setPosition(0, 0);\n\t\t\t\tnote.parent = this.node.parent.parent;\n\t\t\t\tvar self = note;\n\t\t\t\tcc.loader.loadRes('卡牌图片/'+cardName[cardID], cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\t\tself.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t\t});\n\t\t\t\t//开启note节点的监听，点击后消失\n\t\t\t\tnote.on('mousedown', function ( event ) {\n\t\t\t\t\tcc.game.emit('stepOnCell-done');\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}, note);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcc.game.emit('stepOnCell-done');\n\t\t\t}\n\t\t}\n\t\telse if (this.kind == 2) { //事件格\n\t\t\t\n\t\t\t//随机产生6个事件之一\n\t\t\tvar rand_event = Math.floor(Math.random()*6);\n\t\t\t//创建用来提示获得触发事件的精灵节点\n\t\t\tvar note = new cc.Node();\n            note.addComponent(cc.Sprite);\n\t\t\tnote.setPosition(0, 0);\n\t\t\tnote.parent = this.node.parent.parent;\n\t\t\tvar self = note, event_name;\n\t\t\tif (rand_event == 0) { //陷阱\n\t\t\t\tevent_name = \"陷阱\";\n\t\t\t\tperson_js.useCardEnabled = 0; //本回合不可使用卡牌,下回合置1\n\t\t\t\t//to do\n\t\t\t\t//warning: 下回合记得改变\n\t\t\t\t//warning: 下回合记得改变\n\t\t\t\t//warning: 下回合记得改变\n\t\t\t}\t\n\t\t\telse if (rand_event == 1) { //监狱\n\t\t\t\tevent_name = \"监狱\"; //下回合不可走\n\t\t\t\tperson_js.goEnabled = 0;\n\t\t\t\t//to do\n\t\t\t\t//warning: 下回合记得改变\n\t\t\t\t//warning: 下回合记得改变\n\t\t\t\t//warning: 下回合记得改变\n\t\t\t}\t\n\t\t\telse if (rand_event == 2) { //恶魔\n\t\t\t\tevent_name = \"恶魔\";  //损失一滴血量\n\t\t\t\tperson_js.blood--;\n\t\t\t}\t\n\t\t\telse if (rand_event == 3) { //奥利给\n\t\t\t\tevent_name = \"奥利给\";\n\t\t\t\tperson_js.turn++; //获得回合\n\t\t\t}\t\n\t\t\telse if (rand_event == 4) { //视野\n\t\t\t\tevent_name = \"视野\";  //to do\n\t\t\t}\t\n\t\t\telse if (rand_event == 5) { //天使\n\t\t\t\tevent_name = \"天使\";\n\t\t\t\tperson_js.blood = Math.floor(person_js.blood*1.5);\n\t\t\t}\t\n\t\t\tcc.loader.loadRes('事件图片/'+event_name, cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t\t//开启note节点的监听，点击后消失\n\t\t\tnote.on('mousedown', function ( event ) {\n\t\t\t\tcc.game.emit('stepOnCell-done');\n\t\t\t\tthis.destroy();\n\t\t\t\t\n\t\t\t}, note);\n\t\t\t\n\t\t}\n\t},\n\t\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n\t\t\n\t},\n\n    start () {\n\t\t//设置格子图片\n\t\t\n\t\tvar self = this;\n\t\tif (this.kind == 0) { //空白格\n\t\t\tcc.loader.loadRes(\"cell\", cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t}\n\t\telse if (this.kind == 1) { //卡牌格\n\t\t\tcc.loader.loadRes(\"抽卡格\", cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t}\n\t\telse { //事件格\n\t\t\tcc.loader.loadRes(\"事件格\", cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t}\n    },\n\n    // update (dt) {},\n});\n\n\n\n\n\n\n\n\n\n\n\n\n"]}