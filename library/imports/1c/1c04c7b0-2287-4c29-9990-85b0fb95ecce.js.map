{"version":3,"sources":["assets\\scripts\\globalGame.js"],"names":["window","global","persons","nowTurn","isOver","cardnode","bgm","audio","loop","volume","cc","Class","Component","properties","mapObj","index","nowStep","nowPlayer","nowProperty","isWait","msgBoxConent","time","end_card_btn_func","game","emit","find","active","card_end_btn_showed","updateUI","onKeyDown","event","console","log","keyCode","tab","getComponent","showTab","onKeyUp","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","msgContent","poster","timeStr","parseInt","name","RichText","string","height","ScrollView","scrollToBottom","msg","nickname","route","moveByRoute","step","posEnable","map","posX","posY","InitialCard","initBgm","Label","schedule","start","initPersons","update","dt","i","length","property","isDead","mobility","buff","node","todoList","endTurn","act","splice","goEnabled","tip","startRollDice","dice","next","useCardEnabled","btn","aiUseCard","turn","bindAvatar","move2Pos","nowPerson","ctx","Graphics","clear","strokeColor","Color","RED","moveTo","lineWidth","lineTo","stroke","text","fontSize","setPosition","GREEN","loader","loadRes","AudioClip","err","clip","audioID","audioEngine","play","cardName","totCardNum","Array","Node","addComponent","Sprite","SpriteFrame","spriteFrame","bind","push","openMenu","end","director","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["window.global={\n\tpersons:[],\n\tnowTurn:0,//当前回合数\n\tisOver:false,\n\tcardnode : null,\n\tbgm:{\n\t\taudio:null,\n\t\tloop:null,\n\t\tvolume:null,\n\t}\n};\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\t\tmapObj:null,//地图对象\n\t\tpersons:null,//玩家们\n\t\tindex:0,\n\t\tnowStep:0,\n\t\tnowPlayer:null,\n\t\tnowProperty:null,\n\t\tisWait:false,\n\t\tmsgBoxConent:null,\n\t\ttime:0,\n    },\n\t\n\tend_card_btn_func:function() {\n\t\tcc.game.emit('update-state', '1');\n\t\tcc.find(\"Canvas/end_card_btn\").active = false;\n\t\twindow.global.card_end_btn_showed = 0;\n\t},\n\t\n    updateUI:function(){\n\t\t//更新人物血量\n\t},\n\tonKeyDown: function (event) {//键盘按下\n\t\tconsole.log(event);\n        switch(event.keyCode) {\n            case 9:\n\t\t\t{//按下tab\n\t\t\t\tvar tab=cc.find('Canvas/Tab');\n\t\t\t\ttab.active=true;\n\t\t\t\ttab.getComponent('tabWin').showTab();\n\t\t\t\n                break;\n\t\t\t}\n        }\n    },\n\n    onKeyUp: function (event) {//键盘释放\n        switch(event.keyCode) {\n            case 9:\n             {//释放tab\n\t\t\t\tvar tab=cc.find('Canvas/Tab');\n\t\t\t\ttab.active=false;\n\t\t\t\t//console.log('Press a key');\n                break;\n\t\t\t}\n        }\n    },\n    onLoad () {\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n\t\t//加载地图\n\t\tthis.nowStep=0;\n\t\tthis.msgContent=cc.find('Canvas/msgBox/view/content/item');\n\t\t//console.log(msgContent.getComponent(cc.Label));\n\t\tcc.game.on('send-Msg',function(event,poster){\n\t\t\tif (event==''){\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\tvar timeStr='';\n\t\t\tif (parseInt(this.time/60)<10)\n\t\t\t\ttimeStr+=\"0\"\n\t\t\ttimeStr+=parseInt(this.time/60)+\":\";\n\t\t\tif (this.time-parseInt(this.time/60)*60<10)\n\t\t\t\ttimeStr+=\"0\"\n\t\t\ttimeStr+=(this.time-parseInt(this.time/60)*60);\n\t\t\t\n\t\t\tvar name='<color=#43CD80>('+timeStr+')'+poster+'</color>';;\n\t\t\tif (poster=='系统'){\n\t\t\t\tname='<color=#ff0000>('+timeStr+')'+poster+'</color>';\n\t\t\t}\n\t\t\tthis.msgContent.getComponent(cc.RichText).string+=name+\": \"+event+'<br/>';\n\t\t\t//可能需要动态改变content大小\n\t\t\t\n\t\t\tcc.find('Canvas/msgBox/view/content').height=this.msgContent.height+10;\n\t\t\tcc.find('Canvas/msgBox').getComponent(cc.ScrollView).scrollToBottom(0.1);\n\t\t\t//console.log('Label',this.msgContent.height);\n\t\t\t \n\t\t},this);\n\t\t\t\n\t\tcc.game.on('update-state', function (msg) {\n\t\t\tthis.nowStep=(this.nowStep+1)%5;\n\t\t\tthis.isWait=false;\n\t\t\t\n\t\t},this);\n\t\tcc.game.on('stepOnCell-done', function ( event ) {//触发结束\n\t\t\tcc.game.emit('update-state', '1');//更新状态\n\t\t\tconsole.log(event);\n\t\t\tcc.game.emit('send-Msg',event,this.nowProperty.nickname);\n\t\t},this);\n\t\tcc.game.on('route-chosen', function(route) {//监听玩家选择了哪条路径\n\t\t\t\t\t//console.log('点击了',route);\n\t\t\tthis.nowProperty.moveByRoute(route);\n\t\t\t\t\t//this.node.emit('update-state', '1');//玩家移动完成，进入下一步操作\n\t\t\t\t\t//玩家头像按照路径移动\n\t\t},this);\n\t\tcc.game.on('roll-dice-done',function(step){\n\t\t\tcc.game.emit('send-Msg',\"获得骰子点数\"+step,this.nowProperty.nickname);\n\t\t\tconsole.log(this.mapObj.posEnable(this.mapObj.map[this.nowProperty.posX][this.nowProperty.posY],step));\n\t\t},this);\n\t\tthis.InitialCard();\n\t\tthis.initBgm();\n\t\tcc.find('Canvas/time').getComponent(cc.Label).schedule(function() {\n\t\t\t\n\t\t\tcc.find('Canvas').getComponent('globalGame').time+=1;\n\t\t\tvar time=cc.find('Canvas').getComponent('globalGame').time;\n\t\t\t//console.log(time);\n\t\t\tthis.string=\"Time: \"\n\t\t\tif (parseInt(time/60)<10)\n\t\t\t\tthis.string+=\"0\"\n\t\t\tthis.string+=parseInt(time/60)+\":\";\n\t\t\tif (time-parseInt(time/60)*60<10)\n\t\t\t\tthis.string+=\"0\"\n\t\t\tthis.string+=(time-parseInt(time/60)*60);\n\t\t\t//cc.find('Canvas').getComponent('globalGame').timeStr=this.string;\n\t\t }, 1);\n\t\t cc.game.emit('send-Msg','好戏开场了!','系统');\n\t},\n\t\n    start () {\n\t\t//初始化人物\n\t\tthis.initPersons();\n\t\t//获得地图对象\n\t\tthis.mapObj=cc.find('Canvas/map').getComponent('GetMap');\n\t\n\t\tthis.nowPlayer=window.global.persons[this.index];\n\t\t\n\t\t\n\t\t\n    },\n\n    update (dt) {\n\t\t//判断当前回合是否结束\n\t\t\n\t\tconsole.log(\"是否等待操作\",this.isWait);\n\t\tswitch (this.nowStep){\n\t\t\tcase 0:{//初始化变量\n\t\t\t\tif (this.isWait){//正在操作或等待操作\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this.index==0){\n\t\t\t\t\twindow.global.nowTurn+=1;\n\t\t\t\t\t\n\t\t\t\t\tfor (var i=0;i<window.global.persons.length;i++){\n\t\t\t\t\t\tvar property=window.global.persons[i].getComponent('Person');\n\t\t\t\t\t\tif (property.isDead==0){\n\t\t\t\t\t\t\tproperty.mobility+=2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tvar buff=this.node.getComponent('Buff');\n\t\t\t\tfor (var i=0;i<buff.todoList.length;i++){\n\t\t\t\t\tif (buff.todoList[i].endTurn==window.global.nowTurn){\n\t\t\t\t\t\tif (buff.todoList[i].act()){\n\t\t\t\t\t\t\tbuff.todoList.splice(i,1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.nowProperty=this.nowPlayer.getComponent('Person');//获得玩家属性集合\n\t\t\t\tcc.game.emit('send-Msg','轮到角色'+this.nowProperty.nickname,'系统');\n\t\t\t\tcc.game.emit('update-state', '1');\n\t\t\t\t\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 1:{//玩家移动\n\t\t\t\tif (this.isWait){//正在操作或等待操作\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif (this.nowProperty.goEnabled){//判断玩家是否可以行走\n\t\t\t\t\tvar tip=cc.find('Canvas/tipWin');\n\t\t\t\t\tif (this.nowProperty.nickname=='老叟')\n\t\t\t\t\t\ttip.getComponent('tipWindow').startRollDice();\n\t\t\t\t\telse{\n\t\t\t\t\t\tvar dice=cc.find('Canvas/tipWin/dice').getComponent('SpriteIndex');\n\t\t\t\t\t\tdice.next();\n\t\t\t\t\t\tcc.game.emit('roll-dice-done',dice.index+1);\n\t\t\t\t\t}\n\t\t\t\t\tthis.isWait=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.nowProperty.goEnabled=1;\n\t\t\t\t\tcc.game.emit('update-state', '1');\n\t\t\t\t}\n\t\t\t\t break;\n\t\t\t}\n\t\t\tcase 2:{\n\t\t\t\t//完成了事件触发或者卡牌触发\n\t\t\t\tif (this.isWait){//正在操作或等待操作\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconsole.log(\"当前步骤：\",this.nowStep);\n\t\t\t\tconsole.log(\"玩家出牌\");\n\t\t\t\tcc.game.emit('update-state', '1');\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 3: {\n\t\t\t\t//等待玩家出牌并结束\n\t\t\t\tif (this.nowProperty.useCardEnabled == 1) {\n\t\t\t\t\t//可以出牌\n\t\t\t\t\tif (this.nowPlayer.name == 'Person1') {\n\t\t\t\t\t\tif (window.global.card_end_btn_showed != 1) {\n\t\t\t\t\t\t\tvar btn = cc.find('Canvas/end_card_btn');\n\t\t\t\t\t\t\tbtn.active = true;\n\t\t\t\t\t\t\twindow.global.card_end_btn_showed = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tcc.find('Canvas').getComponent('AI').aiUseCard(this.nowProperty);\n\t\t\t\t\t\t\tcc.game.emit('update-state', '1');\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.nowProperty.useCardEnabled = 1;\n\t\t\t\t\tcc.game.emit('update-state', '1');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 4:{ //这里原本是case:3\n\t\t\t\t//console.log(\"当前步骤：\",this.nowStep);\n\t\t\t\t//当前玩家的回合数-1\n\t\t\t\tthis.nowProperty.turn-=1;\n\t\t\t\tif (this.nowProperty.turn==0)//当前玩家回合数为0，应该切换玩家\n\t\t\t\t{\n\t\t\t\t\tconsole.log(\"切换角色\");\n\t\t\t\t\tthis.nowProperty.turn+=1;\n\t\t\t\t\tthis.index=(this.index+1)%4;\n\t\t\t\t\tthis.nowPlayer=window.global.persons[this.index];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcc.game.emit('update-state', '1');\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t},\n\tinitPersons:function(){\n\t\twindow.global.persons[0].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar1'));\n\t\twindow.global.persons[1].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar2'));\n\t\twindow.global.persons[2].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar3'));\n\t\twindow.global.persons[3].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar4'));\n\t\twindow.global.persons[0].getComponent('Person').nickname='老叟';\n\t\twindow.global.persons[1].getComponent('Person').nickname='少妇';\n\t\twindow.global.persons[2].getComponent('Person').nickname='富商';\n\t\twindow.global.persons[3].getComponent('Person').nickname='小女';\n\t\t//初始化四个玩家位置\n\t\t//console.log(this.mapObj.map[0][0].getPosition());\n\t\twindow.global.persons[0].getComponent('Person').move2Pos(0,0);\n\t\twindow.global.persons[1].getComponent('Person').move2Pos(10,10);\n\t\twindow.global.persons[2].getComponent('Person').move2Pos(0,10);\n\t\twindow.global.persons[3].getComponent('Person').move2Pos(10,0);\n\t\tfor (var i=0;i<window.global.persons.length;i++){\n\t\t\tvar nowPerson=window.global.persons[i];\n\t\t\tvar ctx=cc.find(\"bloodBar/bar\", nowPerson).getComponent(cc.Graphics);\n\t\t\tctx.clear();\n\t\t\tctx.strokeColor = cc.Color.RED;\n\t\t\tctx.moveTo(-40, -150);\n\t\t\tctx.lineWidth=10;\n\t\t\tctx.lineTo(60, -150);\n\t\t\tctx.stroke();   \n\t\t\tvar text=cc.find(\"bloodBar/text\", nowPerson);\n\t\t\ttext.getComponent(cc.Label).fontSize=25;\n\t\t\t//console.log(text.getComponent(cc.Label));\n\t\t\ttext.setPosition(-100,-150);\n\t\t\t\n\t\t\t//设置行动值\n\t\t\tctx=cc.find(\"mobilityBar/bar\", nowPerson).getComponent(cc.Graphics);\n\t\t\tctx.clear();\n\t\t\tctx.strokeColor = cc.Color.GREEN;\n\t\t\tctx.moveTo(-40, -180);\n\t\t\tctx.lineTo(60, -180);\n\t\t\tctx.lineWidth=10;\n\t\t\tctx.stroke();  \n\t\t\ttext=cc.find(\"mobilityBar/text\", nowPerson);\n\t\t\ttext.getComponent(cc.Label).fontSize=25;\n\t\t\t//console.log(text.getComponent(cc.Label));\n\t\t\ttext.setPosition(-100,-200);\t\t\t\n\t\t}\n\t},\n\tinitBgm:function(){\n\t\tcc.loader.loadRes('bgm/天空之城钢琴曲', cc.AudioClip, function (err, clip) {\n\t\t\tvar audioID = cc.audioEngine.play(clip, true, 0.1);\n\t\t});\n\t},\n\tInitialCard: function() {\n\t\tvar cardName = ['炸弹','精准导弹','地雷','庇护','天使的庇护','战神的祝福','虚弱','团队的力量',\n\t\t\t\t\t\t\t'治愈','圣光普照','望远镜','眼睛','猛男的祝福','盗取','束缚','迷惑','拯救'];\n\t\tvar totCardNum = 17;\n\t\twindow.global.cardnode = new Array();\n\t\tfor (var i = 0; i < totCardNum; i++) {\n\t\t\t\n\t\t\tvar node = new cc.Node(cardName[i]);\n\t\t\tnode.addComponent(cc.Sprite);\n\t\t\tnode.cardName = cardName[i];\n\t\t\tcc.loader.loadRes('卡牌图片/'+node.cardName,cc.SpriteFrame,function(err,spriteFrame) {\n\t            this.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t    }.bind(node));\n\t\t\twindow.global.cardnode.push(node);\t\n\t\t}\n\t\t//隐藏结束按钮\n\t\tcc.find('Canvas/end_card_btn').active = false;\n\t\t//隐藏选牌确定按钮\n\t\tcc.find('Canvas/choose_card_confirm').active=false;\n\t\t//隐藏选牌取消按钮\n\t\tcc.find('Canvas/choose_card_cancel').active=false;\n\t\t//初始化BGM\n\t\tthis.initBgm();\n\t},\n\topenMenu:function(){\n\t\t\n\t\tcc.game.end();\n\t\tconsole.log('开始游戏');\n\t\tcc.director.loadScene(\"开始界面\");\n\t\t\n\t}\n});\n\n\n//生成从minNum到maxNum的随机数\n"]}