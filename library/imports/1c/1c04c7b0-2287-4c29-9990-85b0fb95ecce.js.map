{"version":3,"sources":["assets\\scripts\\globalGame.js"],"names":["window","global","persons","nowTurn","isOver","cc","Class","Component","properties","mapObj","index","nowStep","nowPlayer","nowProperty","isWait","onLoad","node","on","msg","game","event","emit","console","log","route","moveByRoute","start","getComponent","bindAvatar","find","move2Pos","update","dt","name","goEnabled","step","randomNum","posX","posY","posEnable","map","Person","num","pos","parter","ID","position","attack","blood","mobility","cards","Array","myStatus","turn","useCardEnabled","minNum","maxNum","arguments","length","parseInt","Math","random"],"mappings":"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","sourceRoot":"/","sourcesContent":["window.global={\r\n\tpersons:[],\r\n\tnowTurn:0,//当前回合数\r\n\tisOver:false,\r\n};\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\t\tmapObj:null,//地图对象\r\n\t\tpersons:null,//玩家们\r\n\t\tindex:0,\r\n\t\tnowStep:0,\r\n\t\tnowPlayer:null,\r\n\t\tnowProperty:null,\r\n\t\tisWait:false,\r\n\t\t\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n\t\t//加载地图\r\n\t\tthis.nowStep=0;\r\n\t\tthis.node.on('update-state', function (msg) {\r\n\t\t\tthis.nowStep=(this.nowStep+1)%4;\r\n\t\t\tthis.isWait=false;\r\n\t\t\t\r\n\t\t},this);\r\n\t\tcc.game.on('stepOnCell-done', function ( event ) {//触发结束\r\n\t\t\tthis.node.emit('update-state', '1');//更新状态\r\n\t\t\tconsole.log(\"触发了特殊格子！\");\r\n\t\t},this);\r\n\t\tcc.game.on('route-chosen', function(route) {//监听玩家选择了哪条路径\r\n\t\t\t\t\tconsole.log('点击了',route);\r\n\t\t\t\t\tthis.nowProperty.moveByRoute(route);\r\n\t\t\t\t\t//this.node.emit('update-state', '1');//玩家移动完成，进入下一步操作\r\n\t\t\t\t\t//玩家头像按照路径移动\r\n\t\t},this);\r\n\t\t\r\n\t\t\r\n\t},\r\n\r\n    start () {\r\n\t\twindow.global.persons[0].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar1'));\r\n\t\twindow.global.persons[1].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar2'));\r\n\t\twindow.global.persons[2].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar3'));\r\n\t\twindow.global.persons[3].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar4'));\r\n\t\tthis.mapObj=cc.find('Canvas/map').getComponent('GetMap');\r\n\t\t//console.log(this.mapObj.posEnable(this.mapObj.map[0][0],3));\r\n\t\tthis.nowPlayer=window.global.persons[this.index];\r\n\t\t//console.log(this.mapObj.map);\r\n\t\t//初始化四个玩家位置\r\n\t\t//console.log(this.mapObj.map[0][0].getPosition());\r\n\t\twindow.global.persons[0].getComponent('Person').move2Pos(0,0);\r\n\t\twindow.global.persons[1].getComponent('Person').move2Pos(10,10);\r\n\t\twindow.global.persons[2].getComponent('Person').move2Pos(0,10);\r\n\t\twindow.global.persons[3].getComponent('Person').move2Pos(10,0);\r\n    },\r\n\r\n    update (dt) {\r\n\t\t//判断当前回合是否结束\r\n\t\t\r\n\t\tconsole.log(\"是否等待操作\",this.isWait);\r\n\t\tswitch (this.nowStep){\r\n\t\t\tcase 0:{//初始化变量\r\n\t\t\t\tif (this.isWait){//正在操作或等待操作\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(this.nowPlayer.name);\r\n\t\t\t\tconsole.log(\"当前步骤：\",this.nowStep);\r\n\t\t\t\tthis.nowProperty=this.nowPlayer.getComponent('Person');//获得玩家属性集合\r\n\t\t\t\tthis.node.emit('update-state', '1');\r\n\t\t\t\t\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase 1:{//玩家移动\r\n\t\t\t\tif (this.isWait){//正在操作或等待操作\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"当前步骤：\",this.nowStep);\r\n\t\t\t\t\r\n\t\t\t\tif (this.nowProperty.goEnabled){//判断玩家是否可以行走\r\n\t\t\t\t\tvar step=randomNum(1,6);//掷骰子，玩家步数\r\n\t\t\t\t\tconsole.log(\"掷骰子:\"+step);\r\n\t\t\t\t\tconsole.log(\"当前起点:\"+this.nowProperty.posX+\",\"+this.nowProperty.posY);\r\n\t\t\t\t\tthis.isWait=true;\r\n\t\t\t\t\tconsole.log(this.mapObj.posEnable(this.mapObj.map[this.nowProperty.posX][this.nowProperty.posY],step));\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis.nowProperty.goEnabled=1;\r\n\t\t\t\t\tthis.node.emit('update-state', '1');\r\n\t\t\t\t}\r\n\t\t\t\t break;\r\n\t\t\t}\r\n\t\t\tcase 2:{\r\n\t\t\t\t//完成了事件触发或者卡牌触发\r\n\t\t\t\tif (this.isWait){//正在操作或等待操作\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"当前步骤：\",this.nowStep);\r\n\t\t\t\tconsole.log(\"玩家出牌\");\r\n\t\t\t\tthis.node.emit('update-state', '1');\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase 3:{\r\n\t\t\t\tconsole.log(\"当前步骤：\",this.nowStep);\r\n\t\t\t\tconsole.log(\"切换角色\");\r\n\t\t\t\tthis.index=(this.index+1)%4;\r\n\t\t\t\tthis.nowPlayer=window.global.persons[this.index];\r\n\t\t\t\tthis.node.emit('update-state', '1');\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//console.log(nowProperty.goEnabled);\r\n\t},\r\n});\r\n\r\nfunction Person(name,num,pos,parter,node){\r\n\tthis.name=name;//玩家昵称\r\n\tthis.ID=num;//玩家编号\r\n\tthis.position=pos;//玩家当前位置\r\n\tthis.attack=1;//玩家攻击力，初始为1点\r\n\tthis.blood=10;//玩家血量,初始为2点，每回合恢复2点\r\n\tthis.mobility=2;//玩家行动值\r\n\tthis.cards=new Array();//玩家持有卡牌组\r\n\tthis.myStatus=1;//0为死亡，1为正常\r\n\tthis.turn=1;//玩家回合数\r\n\tthis.useCardEnabled=1;//是否使用卡牌，1为可使用卡牌\r\n\tthis.goEnabled=1;//是否可以行走,1为可以行走\r\n\tthis.parter=parter;//设置玩家队友id\r\n\tthis.node=node;//人物节点\r\n\treturn this;\r\n}\r\n//生成从minNum到maxNum的随机数\r\nfunction randomNum(minNum,maxNum){ \r\n    switch(arguments.length){ \r\n        case 1: \r\n            return parseInt(Math.random()*minNum+1,10); \r\n        break; \r\n        case 2: \r\n            return parseInt(Math.random()*(maxNum-minNum+1)+minNum,10); \r\n        break; \r\n            default: \r\n                return 0; \r\n            break; \r\n    } \r\n} "]}