
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/Mist.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '7169acSg7NJSr4xdfeK+4B9', 'Mist');
// scripts/Mist.js

"use strict";

// Learn cc.Class:
//  - https://docs.cocos.com/creator/manual/en/scripting/class.html
// Learn Attribute:
//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html
// Learn life-cycle callbacks:
//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html
cc.Class({
  "extends": cc.Component,
  properties: {
    basex: 0,
    basey: 0,
    stepx: 0,
    stepy: 0,
    singleMist: null,
    mistArr: null,
    cnt: 0,
    map: null
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    this.singleMist = new cc.Node();
    this.singleMist.addComponent(cc.Sprite);
    cc.loader.loadRes('迷雾', cc.SpriteFrame, function (err, spriteFrame) {
      this.getComponent(cc.Sprite).spriteFrame = spriteFrame;
    }.bind(this.singleMist));
  },
  start: function start() {},
  getMistArr: function getMistArr() {
    this.map = cc.find('Canvas/map').getComponent('GetMap');
    var map_matrix = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1], [1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1], [1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1], [1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1], [1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1], [1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1], [1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]];
    this.mistArr = new Array();

    for (var i = 0; i < 11; i++) {
      this.mistArr[i] = new Array();

      for (var j = 0; j < 11; j++) {
        if (map_matrix[i][j] == 0) this.mistArr[i][j] = null;else {
          this.mistArr[i][j] = cc.instantiate(this.singleMist);
          this.mistArr[i][j].setPosition(this.basex + this.stepx * i, this.basey + this.stepy * j);
          this.mistArr[i][j].parent = this.node;
        }
      }
    }
  },
  update: function update(dt) {
    if (this.cnt == 10) {
      this.getMistArr();
    }

    this.cnt++;

    if (this.cnt == 16) {
      this.cnt -= 5;
      var person = cc.find('Canvas').getComponent('globalGame').nowProperty;
      var dis = this.map.BfsDis(person.posX, person.posY);

      for (var i = 0; i < 11; i++) {
        for (var j = 0; j < 11; j++) {
          if (dis[i][j] == -1) continue;
          if (dis[i][j] <= person.sight) this.mistArr[i][j].active = false;else this.mistArr[i][j].active = true;
        }
      }

      for (var i = 0; i < person.eyes.length; ++i) {
        for (var j = 0; j < person.eyes[i].length; ++j) {
          this.mistArr[person.eyes[i][j][0]][person.eyes[i][j][1]].active = false;
        }
      }

      var index = Number(person.node.name[6]);
      var teammate = index + 2 > 4 ? index - 2 : index + 2;
      var enemy1 = index + 1 > 4 ? index - 3 : index + 1;
      var enemy2 = teammate + 1 > 4 ? teammate - 3 : teammate + 1;
      teammate = cc.find("Canvas/Persons/Person" + teammate).getComponent('Person');
      dis = this.map.BfsDis(teammate.posX, teammate.posY);

      for (var i = 0; i < 11; i++) {
        for (var j = 0; j < 11; j++) {
          if (dis[i][j] == -1) continue;
          if (dis[i][j] <= person.sight) this.mistArr[i][j].active = false;
        }
      }

      for (var i = 0; i < teammate.eyes.length; ++i) {
        for (var j = 0; j < teammate.eyes[i].length; ++j) {
          this.mistArr[teammate.eyes[i][j][0]][teammate.eyes[i][j][1]].active = false;
        }
      }

      enemy1 = cc.find("Canvas/Persons/Person" + enemy1).getComponent('Person');
      enemy2 = cc.find("Canvas/Persons/Person" + enemy2).getComponent('Person');
      if (enemy1.isDead == 0 && enemy1.exposed == 1) this.mistArr[enemy1.posX][enemy1.posY].active = false;
      if (enemy2.isDead == 0 && enemy2.exposed == 1) this.mistArr[enemy2.posX][enemy2.posY].active = false;
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcTWlzdC5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImJhc2V4IiwiYmFzZXkiLCJzdGVweCIsInN0ZXB5Iiwic2luZ2xlTWlzdCIsIm1pc3RBcnIiLCJjbnQiLCJtYXAiLCJvbkxvYWQiLCJOb2RlIiwiYWRkQ29tcG9uZW50IiwiU3ByaXRlIiwibG9hZGVyIiwibG9hZFJlcyIsIlNwcml0ZUZyYW1lIiwiZXJyIiwic3ByaXRlRnJhbWUiLCJnZXRDb21wb25lbnQiLCJiaW5kIiwic3RhcnQiLCJnZXRNaXN0QXJyIiwiZmluZCIsIm1hcF9tYXRyaXgiLCJBcnJheSIsImkiLCJqIiwiaW5zdGFudGlhdGUiLCJzZXRQb3NpdGlvbiIsInBhcmVudCIsIm5vZGUiLCJ1cGRhdGUiLCJkdCIsInBlcnNvbiIsIm5vd1Byb3BlcnR5IiwiZGlzIiwiQmZzRGlzIiwicG9zWCIsInBvc1kiLCJzaWdodCIsImFjdGl2ZSIsImV5ZXMiLCJsZW5ndGgiLCJpbmRleCIsIk51bWJlciIsIm5hbWUiLCJ0ZWFtbWF0ZSIsImVuZW15MSIsImVuZW15MiIsImlzRGVhZCIsImV4cG9zZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUFBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxTQURQO0FBR0xDLEVBQUFBLFVBQVUsRUFBRTtBQUNkQyxJQUFBQSxLQUFLLEVBQUUsQ0FETztBQUVkQyxJQUFBQSxLQUFLLEVBQUUsQ0FGTztBQUdkQyxJQUFBQSxLQUFLLEVBQUUsQ0FITztBQUlkQyxJQUFBQSxLQUFLLEVBQUUsQ0FKTztBQUtSQyxJQUFBQSxVQUFVLEVBQUUsSUFMSjtBQU1kQyxJQUFBQSxPQUFPLEVBQUUsSUFOSztBQU9kQyxJQUFBQSxHQUFHLEVBQUMsQ0FQVTtBQVFkQyxJQUFBQSxHQUFHLEVBQUM7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RSxNQUFQLElBQWlCLENBQWpCLElBQXNCRixNQUFNLENBQUNHLE9BQVAsSUFBa0IsQ0FBNUMsRUFDQyxLQUFLNUMsT0FBTCxDQUFheUMsTUFBTSxDQUFDVixJQUFwQixFQUEwQlUsTUFBTSxDQUFDVCxJQUFqQyxFQUF1Q0UsTUFBdkMsR0FBZ0QsS0FBaEQ7QUFDRCxVQUFJUSxNQUFNLENBQUNDLE1BQVAsSUFBaUIsQ0FBakIsSUFBc0JELE1BQU0sQ0FBQ0UsT0FBUCxJQUFrQixDQUE1QyxFQUNDLEtBQUs1QyxPQUFMLENBQWEwQyxNQUFNLENBQUNYLElBQXBCLEVBQTBCVyxNQUFNLENBQUNWLElBQWpDLEVBQXVDRSxNQUF2QyxHQUFnRCxLQUFoRDtBQUNEO0FBRUQ7QUFoSE8sQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLy8gTGVhcm4gY2MuQ2xhc3M6XHJcbi8vICAtIGh0dHBzOi8vZG9jcy5jb2Nvcy5jb20vY3JlYXRvci9tYW51YWwvZW4vc2NyaXB0aW5nL2NsYXNzLmh0bWxcclxuLy8gTGVhcm4gQXR0cmlidXRlOlxyXG4vLyAgLSBodHRwczovL2RvY3MuY29jb3MuY29tL2NyZWF0b3IvbWFudWFsL2VuL3NjcmlwdGluZy9yZWZlcmVuY2UvYXR0cmlidXRlcy5odG1sXHJcbi8vIExlYXJuIGxpZmUtY3ljbGUgY2FsbGJhY2tzOlxyXG4vLyAgLSBodHRwczovL2RvY3MuY29jb3MuY29tL2NyZWF0b3IvbWFudWFsL2VuL3NjcmlwdGluZy9saWZlLWN5Y2xlLWNhbGxiYWNrcy5odG1sXHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG5cdFx0YmFzZXg6IDAsXHJcblx0XHRiYXNleTogMCxcclxuXHRcdHN0ZXB4OiAwLFxyXG5cdFx0c3RlcHk6IDAsXHJcbiAgICAgICAgc2luZ2xlTWlzdDogbnVsbCxcclxuXHRcdG1pc3RBcnI6IG51bGwsXHJcblx0XHRjbnQ6MCxcclxuXHRcdG1hcDpudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcclxuXHJcbiAgICBvbkxvYWQgKCkge1xyXG5cdFx0dGhpcy5zaW5nbGVNaXN0ID0gbmV3IGNjLk5vZGUoKTtcclxuXHRcdHRoaXMuc2luZ2xlTWlzdC5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuXHRcdGNjLmxvYWRlci5sb2FkUmVzKCfov7fpm74nLGNjLlNwcml0ZUZyYW1lLGZ1bmN0aW9uKGVycixzcHJpdGVGcmFtZSkge1xyXG7CoCDCoCDCoCDCoCDCoCDCoCB0aGlzLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XHJcblx0wqAgwqAgfS5iaW5kKHRoaXMuc2luZ2xlTWlzdCkpO1xyXG5cdH0sXHJcblxyXG4gICAgc3RhcnQgKCkge1xyXG5cdFx0XHJcblx0XHRcclxuICAgIH0sXHJcblx0Z2V0TWlzdEFycjogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLm1hcCA9IGNjLmZpbmQoJ0NhbnZhcy9tYXAnKS5nZXRDb21wb25lbnQoJ0dldE1hcCcpO1xyXG5cdFx0dmFyIG1hcF9tYXRyaXggPSBbXHJcblx0XHRcdFsxLDEsMSwxLDEsMSwxLDEsMSwxLDFdLFxyXG5cdFx0XHRbMSwxLDAsMCwwLDEsMCwwLDAsMSwxXSxcclxuXHRcdFx0WzEsMCwxLDAsMCwxLDAsMCwxLDAsMV0sXHJcblx0XHRcdFsxLDAsMCwxLDEsMCwxLDEsMCwwLDFdLFxyXG5cdFx0XHRbMSwwLDAsMSwwLDAsMCwxLDAsMCwxXSxcclxuXHRcdFx0WzEsMSwxLDEsMSwxLDEsMSwxLDEsMV0sXHJcblx0XHRcdFsxLDAsMCwxLDAsMCwwLDEsMCwwLDFdLFxyXG5cdFx0XHRbMSwwLDAsMSwxLDAsMSwxLDAsMCwxXSxcclxuXHRcdFx0WzEsMCwxLDAsMCwxLDAsMCwxLDAsMV0sXHJcblx0XHRcdFsxLDEsMCwwLDAsMSwwLDAsMCwxLDFdLFxyXG5cdFx0XHRbMSwxLDEsMSwxLDEsMSwxLDEsMSwxXSxcclxuXHRcdF07XHJcblx0XHR0aGlzLm1pc3RBcnIgPSBuZXcgQXJyYXkoKTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgMTE7IGkrKykge1xyXG5cdFx0XHR0aGlzLm1pc3RBcnJbaV0gPSBuZXcgQXJyYXkoKTtcclxuXHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCAxMTsgaisrKSB7XHJcblx0XHRcdFx0aWYgKG1hcF9tYXRyaXhbaV1bal0gPT0gMClcclxuXHRcdFx0XHRcdHRoaXMubWlzdEFycltpXVtqXSA9IG51bGw7XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdHRoaXMubWlzdEFycltpXVtqXSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc2luZ2xlTWlzdCk7XHJcblx0XHRcdFx0XHR0aGlzLm1pc3RBcnJbaV1bal0uc2V0UG9zaXRpb24odGhpcy5iYXNleCt0aGlzLnN0ZXB4KmksIHRoaXMuYmFzZXkrdGhpcy5zdGVweSpqKTtcclxuXHRcdFx0XHRcdHRoaXMubWlzdEFycltpXVtqXS5wYXJlbnQgPSB0aGlzLm5vZGU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcblx0XHRpZiAodGhpcy5jbnQgPT0gMTApIHtcclxuXHRcdFx0dGhpcy5nZXRNaXN0QXJyKCk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmNudCsrO1xyXG5cdFx0XHJcblx0XHRcclxuXHRcdGlmICh0aGlzLmNudCA9PSAxNikge1xyXG5cdFx0XHR0aGlzLmNudCAtPSA1O1xyXG5cdFx0XHR2YXIgcGVyc29uID0gY2MuZmluZCgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdnbG9iYWxHYW1lJykubm93UHJvcGVydHk7XHJcblx0XHRcdHZhciBkaXMgPSB0aGlzLm1hcC5CZnNEaXMocGVyc29uLnBvc1gsIHBlcnNvbi5wb3NZKTtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAxMTsgaSsrKSB7XHJcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCAxMTsgaisrKSB7XHJcblx0XHRcdFx0XHRpZiAoZGlzW2ldW2pdID09IC0xKVxyXG5cdFx0XHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmIChkaXNbaV1bal0gPD0gcGVyc29uLnNpZ2h0KVxyXG5cdFx0XHRcdFx0XHR0aGlzLm1pc3RBcnJbaV1bal0uYWN0aXZlID0gZmFsc2U7XHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdHRoaXMubWlzdEFycltpXVtqXS5hY3RpdmUgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IgKHZhciBpPTA7aTxwZXJzb24uZXllcy5sZW5ndGg7KytpKXtcclxuXHRcdFx0XHRmb3IgKHZhciBqPTA7ajxwZXJzb24uZXllc1tpXS5sZW5ndGg7KytqKXtcclxuXHRcdFx0XHRcdHRoaXMubWlzdEFycltwZXJzb24uZXllc1tpXVtqXVswXV1bcGVyc29uLmV5ZXNbaV1bal1bMV1dLmFjdGl2ZT1mYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGluZGV4PU51bWJlcihwZXJzb24ubm9kZS5uYW1lWzZdKTtcclxuXHRcdFx0dmFyIHRlYW1tYXRlPWluZGV4KzI+ND9pbmRleC0yOmluZGV4KzI7XHJcblx0XHRcdHZhciBlbmVteTE9aW5kZXgrMT40P2luZGV4LTM6aW5kZXgrMTtcclxuXHRcdFx0dmFyIGVuZW15Mj10ZWFtbWF0ZSsxPjQ/dGVhbW1hdGUtMzp0ZWFtbWF0ZSsxO1xyXG5cdFx0XHR0ZWFtbWF0ZT1jYy5maW5kKFwiQ2FudmFzL1BlcnNvbnMvUGVyc29uXCIrdGVhbW1hdGUpLmdldENvbXBvbmVudCgnUGVyc29uJyk7XHJcblx0XHRcdGRpcyA9IHRoaXMubWFwLkJmc0Rpcyh0ZWFtbWF0ZS5wb3NYLCB0ZWFtbWF0ZS5wb3NZKTtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAxMTsgaSsrKSB7XHJcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCAxMTsgaisrKSB7XHJcblx0XHRcdFx0XHRpZiAoZGlzW2ldW2pdID09IC0xKVxyXG5cdFx0XHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmIChkaXNbaV1bal0gPD0gcGVyc29uLnNpZ2h0KVxyXG5cdFx0XHRcdFx0XHR0aGlzLm1pc3RBcnJbaV1bal0uYWN0aXZlID0gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAodmFyIGk9MDtpPHRlYW1tYXRlLmV5ZXMubGVuZ3RoOysraSl7XHJcblx0XHRcdFx0Zm9yICh2YXIgaj0wO2o8dGVhbW1hdGUuZXllc1tpXS5sZW5ndGg7KytqKVxyXG5cdFx0XHRcdFx0dGhpcy5taXN0QXJyW3RlYW1tYXRlLmV5ZXNbaV1bal1bMF1dW3RlYW1tYXRlLmV5ZXNbaV1bal1bMV1dLmFjdGl2ZT1mYWxzZTtcclxuXHRcdFx0fVx0XHRcdFxyXG5cdFx0XHRcclxuXHRcdFx0ZW5lbXkxPWNjLmZpbmQoXCJDYW52YXMvUGVyc29ucy9QZXJzb25cIitlbmVteTEpLmdldENvbXBvbmVudCgnUGVyc29uJyk7XHJcblx0XHRcdGVuZW15Mj1jYy5maW5kKFwiQ2FudmFzL1BlcnNvbnMvUGVyc29uXCIrZW5lbXkyKS5nZXRDb21wb25lbnQoJ1BlcnNvbicpO1xyXG5cdFx0XHRpZiAoZW5lbXkxLmlzRGVhZCA9PSAwICYmIGVuZW15MS5leHBvc2VkID09IDEpXHJcblx0XHRcdFx0dGhpcy5taXN0QXJyW2VuZW15MS5wb3NYXVtlbmVteTEucG9zWV0uYWN0aXZlID0gZmFsc2U7XHJcblx0XHRcdGlmIChlbmVteTIuaXNEZWFkID09IDAgJiYgZW5lbXkyLmV4cG9zZWQgPT0gMSlcclxuXHRcdFx0XHR0aGlzLm1pc3RBcnJbZW5lbXkyLnBvc1hdW2VuZW15Mi5wb3NZXS5hY3RpdmUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdH0sXHJcbn0pO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXX0=