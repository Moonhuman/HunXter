
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/globalGame.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1c04cewIodMKZmQhbD7lezO', 'globalGame');
// scripts/globalGame.js

"use strict";

window.global = {
  persons: [],
  nowTurn: 0,
  //当前回合数
  isOver: false,
  cardnode: null,
  bgm: {
    audio: null,
    loop: null,
    volume: null
  }
};
cc.Class({
  "extends": cc.Component,
  properties: {
    mapObj: null,
    //地图对象
    persons: null,
    //玩家们
    index: 0,
    nowStep: 0,
    nowPlayer: null,
    nowProperty: null,
    isWait: false,
    msgBoxConent: null,
    time: 0
  },
  updateUI: function updateUI() {//更新人物血量
  },
  onLoad: function onLoad() {
    //加载地图
    this.nowStep = 0;
    this.msgContent = cc.find('Canvas/msgBox/view/content/item'); //console.log(msgContent.getComponent(cc.Label));

    this.node.on('send-Msg', function (event, poster) {
      var timeStr = '';
      if (parseInt(this.time / 60) < 10) timeStr += "0";
      timeStr += parseInt(this.time / 60) + ":";
      if (this.time - parseInt(this.time / 60) * 60 < 10) timeStr += "0";
      timeStr += this.time - parseInt(this.time / 60) * 60;
      var name = '<color=#43CD80>(' + timeStr + ')' + poster + '</color>';

      if (poster == '系统') {
        name = '<color=#ff0000>(' + timeStr + ')' + poster + '</color>';
      }

      this.msgContent.getComponent(cc.RichText).string += name + ": " + event + '<br/>'; //可能需要动态改变content大小

      cc.find('Canvas/msgBox/view/content').height = this.msgContent.height + 10;
      cc.find('Canvas/msgBox').getComponent(cc.ScrollView).scrollToBottom(0.1); //console.log('Label',this.msgContent.height);
    }, this);
    this.node.on('update-state', function (msg) {
      this.nowStep = (this.nowStep + 1) % 4;
      this.isWait = false;
    }, this);
    cc.game.on('stepOnCell-done', function (event) {
      //触发结束
      this.node.emit('update-state', '1'); //更新状态
      //console.log("触发了特殊格子！");
    }, this);
    cc.game.on('route-chosen', function (route) {
      //监听玩家选择了哪条路径
      //console.log('点击了',route);
      this.nowProperty.moveByRoute(route); //this.node.emit('update-state', '1');//玩家移动完成，进入下一步操作
      //玩家头像按照路径移动
    }, this);
    cc.game.on('roll-dice-done', function (event) {
      console.log('yyy');
      var step = randomNum(1, 6); //掷骰子，玩家步数

      this.node.emit('send-Msg', "获得骰子点数" + step, this.nowProperty.nickname);
      console.log(this.mapObj.posEnable(this.mapObj.map[this.nowProperty.posX][this.nowProperty.posY], step));
    }, this);
    this.InitialCard();
    this.initBgm();
    cc.find('Canvas/time').getComponent(cc.Label).schedule(function () {
      cc.find('Canvas').getComponent('globalGame').time += 1;
      var time = cc.find('Canvas').getComponent('globalGame').time; //console.log(time);

      this.string = "Time: ";
      if (parseInt(time / 60) < 10) this.string += "0";
      this.string += parseInt(time / 60) + ":";
      if (time - parseInt(time / 60) * 60 < 10) this.string += "0";
      this.string += time - parseInt(time / 60) * 60; //cc.find('Canvas').getComponent('globalGame').timeStr=this.string;
    }, 1);
    this.node.emit('send-Msg', '好戏开场了!', '系统');
  },
  start: function start() {
    //初始化人物
    this.initPersons(); //获得地图对象

    this.mapObj = cc.find('Canvas/map').getComponent('GetMap');
    this.nowPlayer = window.global.persons[this.index];
  },
  update: function update(dt) {
    //判断当前回合是否结束
    console.log("是否等待操作", this.isWait);

    switch (this.nowStep) {
      case 0:
        {
          //初始化变量
          if (this.isWait) {
            //正在操作或等待操作
            break;
          } //this.node.emit('send-Msg','进入回合'+window.global.nowTurn,'系统');
          //console.log(this.nowPlayer.name);


          this.nowProperty = this.nowPlayer.getComponent('Person'); //获得玩家属性集合

          this.node.emit('send-Msg', '轮到角色' + this.nowProperty.nickname, '系统');
          this.node.emit('update-state', '1');
          break;
        }

      case 1:
        {
          //玩家移动
          if (this.isWait) {
            //正在操作或等待操作
            break;
          }

          if (this.nowProperty.goEnabled) {
            //判断玩家是否可以行走
            var tip = cc.find('Canvas/tipWin'); //tip.active=true;

            var step = randomNum(1, 6); //掷骰子，玩家步数

            this.node.emit('send-Msg', "获得骰子点数" + step, this.nowProperty.nickname);
            console.log(this.mapObj.posEnable(this.mapObj.map[this.nowProperty.posX][this.nowProperty.posY], step));
            this.isWait = true;
          } else {
            this.nowProperty.goEnabled = 1;
            this.node.emit('update-state', '1');
          }

          break;
        }

      case 2:
        {
          //完成了事件触发或者卡牌触发
          if (this.isWait) {
            //正在操作或等待操作
            break;
          }

          console.log("当前步骤：", this.nowStep);
          console.log("玩家出牌");
          this.node.emit('update-state', '1');
          break;
        }

      case 3:
        {
          //console.log("当前步骤：",this.nowStep);
          //当前玩家的回合数-1
          this.nowProperty.turn -= 1;

          if (this.nowProperty.turn == 0) //当前玩家回合数为0，应该切换玩家
            {
              console.log("切换角色");
              this.nowProperty.turn += 1;
              this.index = (this.index + 1) % 4;
              this.nowPlayer = window.global.persons[this.index];
            }

          this.node.emit('update-state', '1');
          break;
        }
    }
  },
  initPersons: function initPersons() {
    window.global.persons[0].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar1'));
    window.global.persons[1].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar2'));
    window.global.persons[2].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar3'));
    window.global.persons[3].getComponent('Person').bindAvatar(cc.find('Canvas/avatar/avatar4'));
    window.global.persons[0].getComponent('Person').nickname = '老叟';
    window.global.persons[1].getComponent('Person').nickname = '少妇';
    window.global.persons[2].getComponent('Person').nickname = '富商';
    window.global.persons[3].getComponent('Person').nickname = '小女'; //初始化四个玩家位置
    //console.log(this.mapObj.map[0][0].getPosition());

    window.global.persons[0].getComponent('Person').move2Pos(0, 0);
    window.global.persons[1].getComponent('Person').move2Pos(10, 10);
    window.global.persons[2].getComponent('Person').move2Pos(0, 10);
    window.global.persons[3].getComponent('Person').move2Pos(10, 0);

    for (var i = 0; i < window.global.persons.length; i++) {
      var nowPerson = window.global.persons[i];
      var ctx = cc.find("bloodBar/bar", nowPerson).getComponent(cc.Graphics);
      ctx.clear();
      ctx.strokeColor = cc.Color.RED;
      ctx.moveTo(-40, -150);
      ctx.lineWidth = 10;
      ctx.lineTo(60, -150);
      ctx.stroke();
      var text = cc.find("bloodBar/text", nowPerson);
      text.getComponent(cc.Label).fontSize = 25; //console.log(text.getComponent(cc.Label));

      text.setPosition(-100, -150); //设置行动值

      ctx = cc.find("mobilityBar/bar", nowPerson).getComponent(cc.Graphics);
      ctx.clear();
      ctx.strokeColor = cc.Color.GREEN;
      ctx.moveTo(-40, -180);
      ctx.lineTo(60, -180);
      ctx.lineWidth = 10;
      ctx.stroke();
      text = cc.find("mobilityBar/text", nowPerson);
      text.getComponent(cc.Label).fontSize = 25; //console.log(text.getComponent(cc.Label));

      text.setPosition(-100, -200);
    }
  },
  initBgm: function initBgm() {
    cc.loader.loadRes('bgm/天空之城钢琴曲', cc.AudioClip, function (err, clip) {
      var audioID = cc.audioEngine.play(clip, true, 0.5);
    });
  },
  InitialCard: function InitialCard() {
    var cardName = ['炸弹', '精准导弹', '地雷', '庇护', '天使的庇护', '战神的祝福', '虚弱', '团队的力量', '治愈', '圣光普照', '望远镜', '眼睛', '猛男的祝福', '盗取', '束缚', '迷惑', '拯救'];
    var totCardNum = 17;
    window.global.cardnode = new Array();

    for (var i = 0; i < totCardNum; i++) {
      var node = new cc.Node(cardName[i]);
      node.addComponent(cc.Sprite);
      node.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(cc.url.raw('resources/卡牌图片/' + cardName[i] + '.jpg'));
      window.global.cardnode.push(node);
    }

    this.initBgm();
  }
}); //生成从minNum到maxNum的随机数

function randomNum(minNum, maxNum) {
  switch (arguments.length) {
    case 1:
      return parseInt(Math.random() * minNum + 1, 10);
      break;

    case 2:
      return parseInt(Math.random() * (maxNum - minNum + 1) + minNum, 10);
      break;

    default:
      return 0;
      break;
  }
}

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcZ2xvYmFsR2FtZS5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJnbG9iYWwiLCJwZXJzb25zIiwibm93VHVybiIsImlzT3ZlciIsImNhcmRub2RlIiwiYmdtIiwiYXVkaW8iLCJsb29wIiwidm9sdW1lIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJtYXBPYmoiLCJpbmRleCIsIm5vd1N0ZXAiLCJub3dQbGF5ZXIiLCJub3dQcm9wZXJ0eSIsImlzV2FpdCIsIm1zZ0JveENvbmVudCIsInRpbWUiLCJ1cGRhdGVVSSIsIm9uTG9hZCIsIm1zZ0NvbnRlbnQiLCJmaW5kIiwibm9kZSIsIm9uIiwiZXZlbnQiLCJwb3N0ZXIiLCJ0aW1lU3RyIiwicGFyc2VJbnQiLCJuYW1lIiwiZ2V0Q29tcG9uZW50IiwiUmljaFRleHQiLCJzdHJpbmciLCJoZWlnaHQiLCJTY3JvbGxWaWV3Iiwic2Nyb2xsVG9Cb3R0b20iLCJtc2ciLCJnYW1lIiwiZW1pdCIsInJvdXRlIiwibW92ZUJ5Um91dGUiLCJjb25zb2xlIiwibG9nIiwic3RlcCIsInJhbmRvbU51bSIsIm5pY2tuYW1lIiwicG9zRW5hYmxlIiwibWFwIiwicG9zWCIsInBvc1kiLCJJbml0aWFsQ2FyZCIsImluaXRCZ20iLCJMYWJlbCIsInNjaGVkdWxlIiwic3RhcnQiLCJpbml0UGVyc29ucyIsInVwZGF0ZSIsImR0IiwiZ29FbmFibGVkIiwidGlwIiwidHVybiIsImJpbmRBdmF0YXIiLCJtb3ZlMlBvcyIsImkiLCJsZW5ndGgiLCJub3dQZXJzb24iLCJjdHgiLCJHcmFwaGljcyIsImNsZWFyIiwic3Ryb2tlQ29sb3IiLCJDb2xvciIsIlJFRCIsIm1vdmVUbyIsImxpbmVXaWR0aCIsImxpbmVUbyIsInN0cm9rZSIsInRleHQiLCJmb250U2l6ZSIsInNldFBvc2l0aW9uIiwiR1JFRU4iLCJsb2FkZXIiLCJsb2FkUmVzIiwiQXVkaW9DbGlwIiwiZXJyIiwiY2xpcCIsImF1ZGlvSUQiLCJhdWRpb0VuZ2luZSIsInBsYXkiLCJjYXJkTmFtZSIsInRvdENhcmROdW0iLCJBcnJheSIsIk5vZGUiLCJhZGRDb21wb25lbnQiLCJTcHJpdGUiLCJzcHJpdGVGcmFtZSIsIlNwcml0ZUZyYW1lIiwidXJsIiwicmF3IiwicHVzaCIsIm1pbk51bSIsIm1heE51bSIsImFyZ3VtZW50cyIsIk1hdGgiLCJyYW5kb20iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUFBLE1BQU0sQ0FBQ0MsTUFBUCxHQUFjO0FBQ2JDLEVBQUFBLE9BQU8sRUFBQyxFQURLO0FBRWJDLEVBQUFBLE9BQU8sRUFBQyxDQUZLO0FBRUg7QUFDVkMsRUFBQUEsTUFBTSxFQUFDLEtBSE07QUFJYkMsRUFBQUEsUUFBUSxFQUFHLElBSkU7QUFLYkMsRUFBQUEsR0FBRyxFQUFDO0FBQ0hDLElBQUFBLEtBQUssRUFBQyxJQURIO0FBRUhDLElBQUFBLElBQUksRUFBQyxJQUZGO0FBR0hDLElBQUFBLE1BQU0sRUFBQztBQUhKO0FBTFMsQ0FBZDtBQVdBQyxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDZEMsSUFBQUEsTUFBTSxFQUFDLElBRE87QUFDRjtBQUNaWixJQUFBQSxPQUFPLEVBQUMsSUFGTTtBQUVEO0FBQ2JhLElBQUFBLEtBQUssRUFBQyxDQUhRO0FBSWRDLElBQUFBLE9BQU8sRUFBQyxDQUpNO0FBS2RDLElBQUFBLFNBQVMsRUFBQyxJQUxJO0FBTWRDLElBQUFBLFdBQVcsRUFBQyxJQU5FO0FBT2RDLElBQUFBLE1BQU0sRUFBQyxLQVBPO0FBUWRDLElBQUFBLFlBQVksRUFBQyxJQVJDO0FBU2RDLElBQUFBLElBQUksRUFBQztBQVRTLEdBSFA7QUFlTEMsRUFBQUEsUUFBUSxFQUFDLG9CQUFVLENBQ3JCO0FBQ0EsR0FqQk87QUFtQkxDLEVBQUFBLE1BbkJLLG9CQW1CSztBQUNaO0FBQ0EsU0FBS1AsT0FBTCxHQUFhLENB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YUFBT3ZFLFFBQVEsQ0FBQzBFLElBQUksQ0FBQ0MsTUFBTCxNQUFlSCxNQUFNLEdBQUNELE1BQVAsR0FBYyxDQUE3QixJQUFnQ0EsTUFBakMsRUFBd0MsRUFBeEMsQ0FBZjtBQUNKOztBQUNJO0FBQ0ksYUFBTyxDQUFQO0FBQ0o7QUFUUjtBQVdIIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ3aW5kb3cuZ2xvYmFsPXtcclxuXHRwZXJzb25zOltdLFxyXG5cdG5vd1R1cm46MCwvL+W9k+WJjeWbnuWQiOaVsFxyXG5cdGlzT3ZlcjpmYWxzZSxcclxuXHRjYXJkbm9kZSA6IG51bGwsXHJcblx0YmdtOntcclxuXHRcdGF1ZGlvOm51bGwsXHJcblx0XHRsb29wOm51bGwsXHJcblx0XHR2b2x1bWU6bnVsbCxcclxuXHR9XHJcbn07XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcblx0XHRtYXBPYmo6bnVsbCwvL+WcsOWbvuWvueixoVxyXG5cdFx0cGVyc29uczpudWxsLC8v546p5a625LusXHJcblx0XHRpbmRleDowLFxyXG5cdFx0bm93U3RlcDowLFxyXG5cdFx0bm93UGxheWVyOm51bGwsXHJcblx0XHRub3dQcm9wZXJ0eTpudWxsLFxyXG5cdFx0aXNXYWl0OmZhbHNlLFxyXG5cdFx0bXNnQm94Q29uZW50Om51bGwsXHJcblx0XHR0aW1lOjAsXHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVVJOmZ1bmN0aW9uKCl7XHJcblx0XHQvL+abtOaWsOS6uueJqeihgOmHj1xyXG5cdH0sXHJcblxyXG4gICAgb25Mb2FkICgpIHtcclxuXHRcdC8v5Yqg6L295Zyw5Zu+XHJcblx0XHR0aGlzLm5vd1N0ZXA9MDtcclxuXHRcdHRoaXMubXNnQ29udGVudD1jYy5maW5kKCdDYW52YXMvbXNnQm94L3ZpZXcvY29udGVudC9pdGVtJyk7XHJcblx0XHQvL2NvbnNvbGUubG9nKG1zZ0NvbnRlbnQuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKSk7XHJcblx0XHR0aGlzLm5vZGUub24oJ3NlbmQtTXNnJyxmdW5jdGlvbihldmVudCxwb3N0ZXIpe1xyXG5cdFx0XHR2YXIgdGltZVN0cj0nJztcclxuXHRcdFx0aWYgKHBhcnNlSW50KHRoaXMudGltZS82MCk8MTApXHJcblx0XHRcdFx0dGltZVN0cis9XCIwXCJcclxuXHRcdFx0dGltZVN0cis9cGFyc2VJbnQodGhpcy50aW1lLzYwKStcIjpcIjtcclxuXHRcdFx0aWYgKHRoaXMudGltZS1wYXJzZUludCh0aGlzLnRpbWUvNjApKjYwPDEwKVxyXG5cdFx0XHRcdHRpbWVTdHIrPVwiMFwiXHJcblx0XHRcdHRpbWVTdHIrPSh0aGlzLnRpbWUtcGFyc2VJbnQodGhpcy50aW1lLzYwKSo2MCk7XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgbmFtZT0nPGNvbG9yPSM0M0NEODA+KCcrdGltZVN0cisnKScrcG9zdGVyKyc8L2NvbG9yPic7XHJcblx0XHRcdGlmIChwb3N0ZXI9PSfns7vnu58nKXtcclxuXHRcdFx0XHRuYW1lPSc8Y29sb3I9I2ZmMDAwMD4oJyt0aW1lU3RyKycpJytwb3N0ZXIrJzwvY29sb3I+JztcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLm1zZ0NvbnRlbnQuZ2V0Q29tcG9uZW50KGNjLlJpY2hUZXh0KS5zdHJpbmcrPW5hbWUrXCI6IFwiK2V2ZW50Kyc8YnIvPic7XHJcblx0XHRcdC8v5Y+v6IO96ZyA6KaB5Yqo5oCB5pS55Y+YY29udGVudOWkp+Wwj1xyXG5cdFx0XHRcclxuXHRcdFx0Y2MuZmluZCgnQ2FudmFzL21zZ0JveC92aWV3L2NvbnRlbnQnKS5oZWlnaHQ9dGhpcy5tc2dDb250ZW50LmhlaWdodCsxMDtcclxuXHRcdFx0Y2MuZmluZCgnQ2FudmFzL21zZ0JveCcpLmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5zY3JvbGxUb0JvdHRvbSgwLjEpO1xyXG5cdFx0XHQvL2NvbnNvbGUubG9nKCdMYWJlbCcsdGhpcy5tc2dDb250ZW50LmhlaWdodCk7XHJcblx0XHRcdCBcclxuXHRcdH0sdGhpcyk7XHJcblx0XHRcdFxyXG5cdFx0dGhpcy5ub2RlLm9uKCd1cGRhdGUtc3RhdGUnLCBmdW5jdGlvbiAobXNnKSB7XHJcblx0XHRcdHRoaXMubm93U3RlcD0odGhpcy5ub3dTdGVwKzEpJTQ7XHJcblx0XHRcdHRoaXMuaXNXYWl0PWZhbHNlO1xyXG5cdFx0XHRcclxuXHRcdH0sdGhpcyk7XHJcblx0XHRjYy5nYW1lLm9uKCdzdGVwT25DZWxsLWRvbmUnLCBmdW5jdGlvbiAoIGV2ZW50ICkgey8v6Kem5Y+R57uT5p2fXHJcblx0XHRcdHRoaXMubm9kZS5lbWl0KCd1cGRhdGUtc3RhdGUnLCAnMScpOy8v5pu05paw54q25oCBXHJcblx0XHRcdC8vY29uc29sZS5sb2coXCLop6blj5HkuobnibnmrormoLzlrZDvvIFcIik7XHJcblx0XHR9LHRoaXMpO1xyXG5cdFx0Y2MuZ2FtZS5vbigncm91dGUtY2hvc2VuJywgZnVuY3Rpb24ocm91dGUpIHsvL+ebkeWQrOeOqeWutumAieaLqeS6huWTquadoei3r+W+hFxyXG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZygn54K55Ye75LqGJyxyb3V0ZSk7XHJcblx0XHRcdHRoaXMubm93UHJvcGVydHkubW92ZUJ5Um91dGUocm91dGUpO1xyXG5cdFx0XHRcdFx0Ly90aGlzLm5vZGUuZW1pdCgndXBkYXRlLXN0YXRlJywgJzEnKTsvL+eOqeWutuenu+WKqOWujOaIkO+8jOi/m+WFpeS4i+S4gOatpeaTjeS9nFxyXG5cdFx0XHRcdFx0Ly/njqnlrrblpLTlg4/mjInnhafot6/lvoTnp7vliqhcclxuXHRcdH0sdGhpcyk7XHJcblx0XHRjYy5nYW1lLm9uKCdyb2xsLWRpY2UtZG9uZScsZnVuY3Rpb24oZXZlbnQpe1xyXG5cdFx0XHRjb25zb2xlLmxvZygneXl5Jyk7XHJcblx0XHRcdHZhciBzdGVwPXJhbmRvbU51bSgxLDYpOy8v5o636aqw5a2Q77yM546p5a625q2l5pWwXHJcblx0XHRcdHRoaXMubm9kZS5lbWl0KCdzZW5kLU1zZycsXCLojrflvpfpqrDlrZDngrnmlbBcIitzdGVwLHRoaXMubm93UHJvcGVydHkubmlja25hbWUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyh0aGlzLm1hcE9iai5wb3NFbmFibGUodGhpcy5tYXBPYmoubWFwW3RoaXMubm93UHJvcGVydHkucG9zWF1bdGhpcy5ub3dQcm9wZXJ0eS5wb3NZXSxzdGVwKSk7XHJcblx0XHRcdFx0XHRcclxuXHRcdH0sdGhpcyk7XHJcblx0XHR0aGlzLkluaXRpYWxDYXJkKCk7XHJcblx0XHR0aGlzLmluaXRCZ20oKTtcclxuXHRcdGNjLmZpbmQoJ0NhbnZhcy90aW1lJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zY2hlZHVsZShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHJcblx0XHRcdGNjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnZ2xvYmFsR2FtZScpLnRpbWUrPTE7XHJcblx0XHRcdHZhciB0aW1lPWNjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnZ2xvYmFsR2FtZScpLnRpbWU7XHJcblx0XHRcdC8vY29uc29sZS5sb2codGltZSk7XHJcblx0XHRcdHRoaXMuc3RyaW5nPVwiVGltZTogXCJcclxuXHRcdFx0aWYgKHBhcnNlSW50KHRpbWUvNjApPDEwKVxyXG5cdFx0XHRcdHRoaXMuc3RyaW5nKz1cIjBcIlxyXG5cdFx0XHR0aGlzLnN0cmluZys9cGFyc2VJbnQodGltZS82MCkrXCI6XCI7XHJcblx0XHRcdGlmICh0aW1lLXBhcnNlSW50KHRpbWUvNjApKjYwPDEwKVxyXG5cdFx0XHRcdHRoaXMuc3RyaW5nKz1cIjBcIlxyXG5cdFx0XHR0aGlzLnN0cmluZys9KHRpbWUtcGFyc2VJbnQodGltZS82MCkqNjApO1xyXG5cdFx0XHQvL2NjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnZ2xvYmFsR2FtZScpLnRpbWVTdHI9dGhpcy5zdHJpbmc7XHJcblx0XHQgfSwgMSk7XHJcblx0XHQgdGhpcy5ub2RlLmVtaXQoJ3NlbmQtTXNnJywn5aW95oiP5byA5Zy65LqGIScsJ+ezu+e7nycpO1xyXG5cdH0sXHJcblx0XHJcbiAgICBzdGFydCAoKSB7XHJcblx0XHQvL+WIneWni+WMluS6uueJqVxyXG5cdFx0dGhpcy5pbml0UGVyc29ucygpO1xyXG5cdFx0Ly/ojrflvpflnLDlm77lr7nosaFcclxuXHRcdHRoaXMubWFwT2JqPWNjLmZpbmQoJ0NhbnZhcy9tYXAnKS5nZXRDb21wb25lbnQoJ0dldE1hcCcpO1xyXG5cdFxyXG5cdFx0dGhpcy5ub3dQbGF5ZXI9d2luZG93Lmdsb2JhbC5wZXJzb25zW3RoaXMuaW5kZXhdO1xyXG5cdFx0XHJcblx0XHRcclxuXHRcdFxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcblx0XHQvL+WIpOaWreW9k+WJjeWbnuWQiOaYr+WQpue7k+adn1xyXG5cdFx0XHJcblx0XHRjb25zb2xlLmxvZyhcIuaYr+WQpuetieW+heaTjeS9nFwiLHRoaXMuaXNXYWl0KTtcclxuXHRcdHN3aXRjaCAodGhpcy5ub3dTdGVwKXtcclxuXHRcdFx0Y2FzZSAwOnsvL+WIneWni+WMluWPmOmHj1xyXG5cdFx0XHRcdGlmICh0aGlzLmlzV2FpdCl7Ly/mraPlnKjmk43kvZzmiJbnrYnlvoXmk43kvZxcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvL3RoaXMubm9kZS5lbWl0KCdzZW5kLU1zZycsJ+i/m+WFpeWbnuWQiCcrd2luZG93Lmdsb2JhbC5ub3dUdXJuLCfns7vnu58nKTtcclxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKHRoaXMubm93UGxheWVyLm5hbWUpO1xyXG5cdFx0XHRcdHRoaXMubm93UHJvcGVydHk9dGhpcy5ub3dQbGF5ZXIuZ2V0Q29tcG9uZW50KCdQZXJzb24nKTsvL+iOt+W+l+eOqeWutuWxnuaAp+mbhuWQiFxyXG5cdFx0XHRcdHRoaXMubm9kZS5lbWl0KCdzZW5kLU1zZycsJ+i9ruWIsOinkuiJsicrdGhpcy5ub3dQcm9wZXJ0eS5uaWNrbmFtZSwn57O757ufJyk7XHJcblx0XHRcdFx0dGhpcy5ub2RlLmVtaXQoJ3VwZGF0ZS1zdGF0ZScsICcxJyk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2FzZSAxOnsvL+eOqeWutuenu+WKqFxyXG5cdFx0XHRcdGlmICh0aGlzLmlzV2FpdCl7Ly/mraPlnKjmk43kvZzmiJbnrYnlvoXmk43kvZxcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAodGhpcy5ub3dQcm9wZXJ0eS5nb0VuYWJsZWQpey8v5Yik5pat546p5a625piv5ZCm5Y+v5Lul6KGM6LWwXHJcblx0XHRcdFx0XHR2YXIgdGlwPWNjLmZpbmQoJ0NhbnZhcy90aXBXaW4nKTtcclxuXHRcdFx0XHRcdC8vdGlwLmFjdGl2ZT10cnVlO1xyXG5cdFx0XHRcdFx0dmFyIHN0ZXA9cmFuZG9tTnVtKDEsNik7Ly/mjrfpqrDlrZDvvIznjqnlrrbmraXmlbBcclxuXHRcdFx0XHRcdHRoaXMubm9kZS5lbWl0KCdzZW5kLU1zZycsXCLojrflvpfpqrDlrZDngrnmlbBcIitzdGVwLHRoaXMubm93UHJvcGVydHkubmlja25hbWUpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2codGhpcy5tYXBPYmoucG9zRW5hYmxlKHRoaXMubWFwT2JqLm1hcFt0aGlzLm5vd1Byb3BlcnR5LnBvc1hdW3RoaXMubm93UHJvcGVydHkucG9zWV0sc3RlcCkpO1xyXG5cdFx0XHRcdFx0dGhpcy5pc1dhaXQ9dHJ1ZTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2V7XHJcblx0XHRcdFx0XHR0aGlzLm5vd1Byb3BlcnR5LmdvRW5hYmxlZD0xO1xyXG5cdFx0XHRcdFx0dGhpcy5ub2RlLmVtaXQoJ3VwZGF0ZS1zdGF0ZScsICcxJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCBicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0XHRjYXNlIDI6e1xyXG5cdFx0XHRcdC8v5a6M5oiQ5LqG5LqL5Lu26Kem5Y+R5oiW6ICF5Y2h54mM6Kem5Y+RXHJcblx0XHRcdFx0aWYgKHRoaXMuaXNXYWl0KXsvL+ato+WcqOaTjeS9nOaIluetieW+heaTjeS9nFxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwi5b2T5YmN5q2l6aqk77yaXCIsdGhpcy5ub3dTdGVwKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIueOqeWutuWHuueJjFwiKTtcclxuXHRcdFx0XHR0aGlzLm5vZGUuZW1pdCgndXBkYXRlLXN0YXRlJywgJzEnKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0XHRjYXNlIDM6e1xyXG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCLlvZPliY3mraXpqqTvvJpcIix0aGlzLm5vd1N0ZXApO1xyXG5cdFx0XHRcdC8v5b2T5YmN546p5a6255qE5Zue5ZCI5pWwLTFcclxuXHRcdFx0XHR0aGlzLm5vd1Byb3BlcnR5LnR1cm4tPTE7XHJcblx0XHRcdFx0aWYgKHRoaXMubm93UHJvcGVydHkudHVybj09MCkvL+W9k+WJjeeOqeWutuWbnuWQiOaVsOS4ujDvvIzlupTor6XliIfmjaLnjqnlrrZcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIuWIh+aNouinkuiJslwiKTtcclxuXHRcdFx0XHRcdHRoaXMubm93UHJvcGVydHkudHVybis9MTtcclxuXHRcdFx0XHRcdHRoaXMuaW5kZXg9KHRoaXMuaW5kZXgrMSklNDtcclxuXHRcdFx0XHRcdHRoaXMubm93UGxheWVyPXdpbmRvdy5nbG9iYWwucGVyc29uc1t0aGlzLmluZGV4XTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0dGhpcy5ub2RlLmVtaXQoJ3VwZGF0ZS1zdGF0ZScsICcxJyk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdH0sXHJcblx0aW5pdFBlcnNvbnM6ZnVuY3Rpb24oKXtcclxuXHRcdHdpbmRvdy5nbG9iYWwucGVyc29uc1swXS5nZXRDb21wb25lbnQoJ1BlcnNvbicpLmJpbmRBdmF0YXIoY2MuZmluZCgnQ2FudmFzL2F2YXRhci9hdmF0YXIxJykpO1xyXG5cdFx0d2luZG93Lmdsb2JhbC5wZXJzb25zWzFdLmdldENvbXBvbmVudCgnUGVyc29uJykuYmluZEF2YXRhcihjYy5maW5kKCdDYW52YXMvYXZhdGFyL2F2YXRhcjInKSk7XHJcblx0XHR3aW5kb3cuZ2xvYmFsLnBlcnNvbnNbMl0uZ2V0Q29tcG9uZW50KCdQZXJzb24nKS5iaW5kQXZhdGFyKGNjLmZpbmQoJ0NhbnZhcy9hdmF0YXIvYXZhdGFyMycpKTtcclxuXHRcdHdpbmRvdy5nbG9iYWwucGVyc29uc1szXS5nZXRDb21wb25lbnQoJ1BlcnNvbicpLmJpbmRBdmF0YXIoY2MuZmluZCgnQ2FudmFzL2F2YXRhci9hdmF0YXI0JykpO1xyXG5cdFx0d2luZG93Lmdsb2JhbC5wZXJzb25zWzBdLmdldENvbXBvbmVudCgnUGVyc29uJykubmlja25hbWU9J+iAgeWPnyc7XHJcblx0XHR3aW5kb3cuZ2xvYmFsLnBlcnNvbnNbMV0uZ2V0Q29tcG9uZW50KCdQZXJzb24nKS5uaWNrbmFtZT0n5bCR5aaHJztcclxuXHRcdHdpbmRvdy5nbG9iYWwucGVyc29uc1syXS5nZXRDb21wb25lbnQoJ1BlcnNvbicpLm5pY2tuYW1lPSflr4zllYYnO1xyXG5cdFx0d2luZG93Lmdsb2JhbC5wZXJzb25zWzNdLmdldENvbXBvbmVudCgnUGVyc29uJykubmlja25hbWU9J+Wwj+Wlsyc7XHJcblx0XHQvL+WIneWni+WMluWbm+S4queOqeWutuS9jee9rlxyXG5cdFx0Ly9jb25zb2xlLmxvZyh0aGlzLm1hcE9iai5tYXBbMF1bMF0uZ2V0UG9zaXRpb24oKSk7XHJcblx0XHR3aW5kb3cuZ2xvYmFsLnBlcnNvbnNbMF0uZ2V0Q29tcG9uZW50KCdQZXJzb24nKS5tb3ZlMlBvcygwLDApO1xyXG5cdFx0d2luZG93Lmdsb2JhbC5wZXJzb25zWzFdLmdldENvbXBvbmVudCgnUGVyc29uJykubW92ZTJQb3MoMTAsMTApO1xyXG5cdFx0d2luZG93Lmdsb2JhbC5wZXJzb25zWzJdLmdldENvbXBvbmVudCgnUGVyc29uJykubW92ZTJQb3MoMCwxMCk7XHJcblx0XHR3aW5kb3cuZ2xvYmFsLnBlcnNvbnNbM10uZ2V0Q29tcG9uZW50KCdQZXJzb24nKS5tb3ZlMlBvcygxMCwwKTtcclxuXHRcdGZvciAodmFyIGk9MDtpPHdpbmRvdy5nbG9iYWwucGVyc29ucy5sZW5ndGg7aSsrKXtcclxuXHRcdFx0dmFyIG5vd1BlcnNvbj13aW5kb3cuZ2xvYmFsLnBlcnNvbnNbaV07XHJcblx0XHRcdHZhciBjdHg9Y2MuZmluZChcImJsb29kQmFyL2JhclwiLCBub3dQZXJzb24pLmdldENvbXBvbmVudChjYy5HcmFwaGljcyk7XHJcblx0XHRcdGN0eC5jbGVhcigpO1xyXG5cdFx0XHRjdHguc3Ryb2tlQ29sb3IgPSBjYy5Db2xvci5SRUQ7XHJcblx0XHRcdGN0eC5tb3ZlVG8oLTQwLCAtMTUwKTtcclxuXHRcdFx0Y3R4LmxpbmVXaWR0aD0xMDtcclxuXHRcdFx0Y3R4LmxpbmVUbyg2MCwgLTE1MCk7XHJcblx0XHRcdGN0eC5zdHJva2UoKTsgICBcclxuXHRcdFx0dmFyIHRleHQ9Y2MuZmluZChcImJsb29kQmFyL3RleHRcIiwgbm93UGVyc29uKTtcclxuXHRcdFx0dGV4dC5nZXRDb21wb25lbnQoY2MuTGFiZWwpLmZvbnRTaXplPTI1O1xyXG5cdFx0XHQvL2NvbnNvbGUubG9nKHRleHQuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKSk7XHJcblx0XHRcdHRleHQuc2V0UG9zaXRpb24oLTEwMCwtMTUwKTtcclxuXHRcdFx0XHJcblx0XHRcdC8v6K6+572u6KGM5Yqo5YC8XHJcblx0XHRcdGN0eD1jYy5maW5kKFwibW9iaWxpdHlCYXIvYmFyXCIsIG5vd1BlcnNvbikuZ2V0Q29tcG9uZW50KGNjLkdyYXBoaWNzKTtcclxuXHRcdFx0Y3R4LmNsZWFyKCk7XHJcblx0XHRcdGN0eC5zdHJva2VDb2xvciA9IGNjLkNvbG9yLkdSRUVOO1xyXG5cdFx0XHRjdHgubW92ZVRvKC00MCwgLTE4MCk7XHJcblx0XHRcdGN0eC5saW5lVG8oNjAsIC0xODApO1xyXG5cdFx0XHRjdHgubGluZVdpZHRoPTEwO1xyXG5cdFx0XHRjdHguc3Ryb2tlKCk7ICBcclxuXHRcdFx0dGV4dD1jYy5maW5kKFwibW9iaWxpdHlCYXIvdGV4dFwiLCBub3dQZXJzb24pO1xyXG5cdFx0XHR0ZXh0LmdldENvbXBvbmVudChjYy5MYWJlbCkuZm9udFNpemU9MjU7XHJcblx0XHRcdC8vY29uc29sZS5sb2codGV4dC5nZXRDb21wb25lbnQoY2MuTGFiZWwpKTtcclxuXHRcdFx0dGV4dC5zZXRQb3NpdGlvbigtMTAwLC0yMDApO1x0XHRcdFxyXG5cdFx0fVxyXG5cdH0sXHJcblx0aW5pdEJnbTpmdW5jdGlvbigpe1xyXG5cdFx0Y2MubG9hZGVyLmxvYWRSZXMoJ2JnbS/lpKnnqbrkuYvln47pkqLnkLTmm7InLCBjYy5BdWRpb0NsaXAsIGZ1bmN0aW9uIChlcnIsIGNsaXApIHtcclxuXHRcdFx0dmFyIGF1ZGlvSUQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5KGNsaXAsIHRydWUsIDAuNSk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdEluaXRpYWxDYXJkOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBjYXJkTmFtZSA9IFsn54K45by5Jywn57K+5YeG5a+85by5Jywn5Zyw6Zu3Jywn5bqH5oqkJywn5aSp5L2/55qE5bqH5oqkJywn5oiY56We55qE56Wd56aPJywn6Jma5byxJywn5Zui6Zif55qE5Yqb6YePJyxcclxuXHRcdFx0XHRcdFx0XHQn5rK75oSIJywn5Zyj5YWJ5pmu54WnJywn5pyb6L+c6ZWcJywn55y8552bJywn54yb55S355qE56Wd56aPJywn55uX5Y+WJywn5p2f57yaJywn6L+35oORJywn5ouv5pWRJ107XHJcblx0XHR2YXIgdG90Q2FyZE51bSA9IDE3O1xyXG5cdFx0d2luZG93Lmdsb2JhbC5jYXJkbm9kZSA9IG5ldyBBcnJheSgpO1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0b3RDYXJkTnVtOyBpKyspIHtcclxuXHRcdFx0dmFyIG5vZGUgPSBuZXcgY2MuTm9kZShjYXJkTmFtZVtpXSk7XHJcblx0XHRcdG5vZGUuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblx0XHRcdG5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoY2MudXJsLnJhdygncmVzb3VyY2VzL+WNoeeJjOWbvueJhy8nK2NhcmROYW1lW2ldKycuanBnJykpO1xyXG5cdFx0XHR3aW5kb3cuZ2xvYmFsLmNhcmRub2RlLnB1c2gobm9kZSk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmluaXRCZ20oKTtcclxuXHR9LFxyXG59KTtcclxuXHJcblxyXG4vL+eUn+aIkOS7jm1pbk51beWIsG1heE51beeahOmaj+acuuaVsFxyXG5mdW5jdGlvbiByYW5kb21OdW0obWluTnVtLG1heE51bSl7IFxyXG4gICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpeyBcclxuICAgICAgICBjYXNlIDE6IFxyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoTWF0aC5yYW5kb20oKSptaW5OdW0rMSwxMCk7IFxyXG4gICAgICAgIGJyZWFrOyBcclxuICAgICAgICBjYXNlIDI6IFxyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoTWF0aC5yYW5kb20oKSoobWF4TnVtLW1pbk51bSsxKSttaW5OdW0sMTApOyBcclxuICAgICAgICBicmVhazsgXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7IFxyXG4gICAgICAgICAgICBicmVhazsgXHJcbiAgICB9IFxyXG59ICJdfQ==