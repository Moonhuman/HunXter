
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/Cell.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a088blxo9JDma4uk/IA4USI', 'Cell');
// scripts/Cell.js

"use strict";

// Learn cc.Class:
//  - https://docs.cocos.com/creator/manual/en/scripting/class.html
// Learn Attribute:
//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html
// Learn life-cycle callbacks:
//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html
cc.Class({
  "extends": cc.Component,
  properties: {
    mapx: 0,
    //在map[i][j]中的横坐标
    mapy: 0,
    //在map[i][j]中的纵坐标
    kind: null,
    //格子的类型，0:空白格，1:卡牌格，2:事件格
    inMonitor: 0,
    //用来判断是否处于监听中的标记
    routeID: null //记录这个cell是map中哪条route的终点，即在routes中的下标

  },
  setColor: function setColor() {
    //设置cell的颜色为绿色，表示可走
    this.node.color = cc.color(102, 255, 102, 255);
  },
  resetColor: function resetColor() {
    //还原cell的颜色
    this.node.color = cc.color(255, 255, 255, 255);
  },
  getOneCard: function getOneCard(person_js, cardName, totCardNum) {
    //随机获得1张牌
    var cardID = Math.floor(Math.random() * totCardNum);
    person_js.cards.push(cardID);

    if (person_js.node.name == 'Person1') {
      //创建用来提示获得卡牌的精灵节点
      var node = cc.instantiate(window.global.cardnode[cardID]);
      node.setPosition(0, 0); //开启note节点的监听，点击后消失

      node.msg = '获得卡牌:' + cardName[cardID];
      node.on('mousedown', function (event) {
        cc.game.emit('stepOnCell-done', this.msg);
        this.destroy();
      }, node);
      node.parent = this.node.parent.parent;
    } else cc.game.emit('stepOnCell-done', '获得卡牌:' + cardName[cardID]);
  },
  chooseFromThree: function chooseFromThree(cardName, totCardNum) {
    var cd = [];
    cd[0] = Math.floor(Math.random() * totCardNum);
    cd[1] = Math.floor(Math.random() * totCardNum);
    cd[2] = Math.floor(Math.random() * totCardNum);

    if (cc.find('Canvas').getComponent('globalGame').nowPlayer.name == 'Person1') {
      for (var i = 0; i < 3; i++) {
        var node = cc.instantiate(window.global.cardnode[cd[i]]);
        node.name = 'chooseFromThree' + i;
        node.setPosition(-500 + 500 * i, 0);
        node.cardID = cd[i];
        node.msg = '获得卡牌:' + cardName[cd[i]];
        node.on('mousedown', function (event) {
          var person_js = cc.find('Canvas').getComponent('globalGame').nowPlayer.getComponent('Person');
          console.log('得到卡牌:' + this.cardID);
          person_js.cards.push(this.cardID);
          cc.game.emit('stepOnCell-done', this.msg);

          for (var j = 0; j < 3; j++) {
            cc.find('Canvas/chooseFromThree' + j).destroy();
          }
        }, node);
        node.parent = this.node.parent.parent;
      }
    } else {
      var index = Math.floor(Math.random() * 3);
      cc.find('Canvas').getComponent('globalGame').nowProperty.cards.push(cd[index]);
      cc.game.emit('stepOnCell-done', '获得卡牌:' + cardName[cd[index]]);
    }
  },
  eventAction: function eventAction(person_js) {
    //随机产生6个事件之一
    var rand_event = Math.floor(Math.random() * 6); //创建用来提示获得触发事件的精灵节点

    var note = new cc.Node();
    note.addComponent(cc.Sprite);
    note.setPosition(0, 0);
    note.parent = this.node.parent.parent;
    var self = note,
        event_name;

    if (rand_event == 0) {
      //陷阱
      event_name = "陷阱";
      person_js.useCardEnabled = 0; //本回合不可使用卡牌,下回合置1
      //warning: 下回合记得改变
    } else if (rand_event == 1) {
      //监狱
      event_name = "监狱"; //下回合不可走

      person_js.goEnabled = 0; //warning: 下回合记得改变
    } else if (rand_event == 2) {
      //恶魔
      event_name = "恶魔"; //损失一滴血量

      person_js.blood--;
    } else if (rand_event == 3) {
      //奥利给
      event_name = "奥利给";
      person_js.turn++; //获得回合
    } else if (rand_event == 4) {
      //视野
      event_name = "视野"; //to do
    } else if (rand_event == 5) {
      //天使
      event_name = "天使";
      person_js.blood = Math.floor(person_js.blood * 1.5);
    }

    if (person_js.node.name == 'Person1') {
      cc.loader.loadRes('事件图片/' + event_name, cc.SpriteFrame, function (err, spriteFrame) {
        self.getComponent(cc.Sprite).spriteFrame = spriteFrame;
      }); //开启note节点的监听，点击后消失

      note.msg = '触发事件:' + event_name;
      note.on('mousedown', function (event) {
        cc.game.emit('stepOnCell-done', this.msg);
        this.destroy();
      }, note);
    } else cc.game.emit('stepOnCell-done', '触发事件:' + event_name);
  },
  specialJudge: function specialJudge(role) {
    if (this.haveMine == 1) {
      role.exposed = 1;
      role.blood -= this.mineAttack;
      if (role.blood <= 0) role.isDead = 1;
      console.log('****', this.mineAttack);
      var buff = cc.find('Canvas').getComponent('Buff');
      buff.todoList.push({
        endTurn: window.global.nowTurn + 1,
        person: role,
        act: function act() {
          if (this.person != cc.find('Canvas').getComponent('globalGame').nowProperty) return false;
          this.person.exposed = 0;
          return true;
        }
      });
      this.haveMine = 0;
    }
  },
  stepOnCell: function stepOnCell(person) {
    //获取person节点的组件
    var person_js = person.getComponent('Person');
    this.specialJudge(person_js);

    if (this.kind == 0) {
      //空白格
      cc.game.emit('stepOnCell-done', ''); //发送空串

      return;
    } else if (this.kind == 1) {
      //卡牌格
      var cardName = ['炸弹', '精准导弹', '地雷', '庇护', '天使的庇护', '战神的祝福', '虚弱', '团队的力量', '治愈', '圣光普照', '望远镜', '眼睛', '猛男的祝福', '盗取', '束缚', '迷惑', '拯救'];
      var totCardNum = 17;
      var rand_val = Math.random();
      console.log('rand_val' + rand_val);

      if (rand_val < 0.5) {
        //得到一张牌
        this.getOneCard(person_js, cardName, totCardNum);
      } else {
        //三张中抽一张
        this.chooseFromThree(cardName, totCardNum);
      }
    } else if (this.kind == 2) {
      //事件格
      this.eventAction(person_js); //响应事件
    }
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {},
  start: function start() {
    //设置格子图片
    var self = this;

    if (this.kind == 0) {
      //空白格
      cc.loader.loadRes("cell", cc.SpriteFrame, function (err, spriteFrame) {
        self.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;
      });
    } else if (this.kind == 1) {
      //卡牌格
      cc.loader.loadRes("抽卡格", cc.SpriteFrame, function (err, spriteFrame) {
        self.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;
      });
    } else {
      //事件格
      cc.loader.loadRes("事件格", cc.SpriteFrame, function (err, spriteFrame) {
        self.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;
      });
    }
  } // update (dt) {},

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcQ2VsbC5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm1hcHgiLCJtYXB5Iiwia2luZCIsImluTW9uaXRvciIsInJvdXRlSUQiLCJzZXRDb2xvciIsIm5vZGUiLCJjb2xvciIsInJlc2V0Q29sb3IiLCJnZXRPbmVDYXJkIiwicGVyc29uX2pzIiwiY2FyZE5hbWUiLCJ0b3RDYXJkTnVtIiwiY2FyZElEIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiY2FyZHMiLCJwdXNoIiwibmFtZSIsImluc3RhbnRpYXRlIiwid2luZG93IiwiZ2xvYmFsIiwiY2FyZG5vZGUiLCJzZXRQb3NpdGlvbiIsIm1zZyIsIm9uIiwiZXZlbnQiLCJnYW1lIiwiZW1pdCIsImRlc3Ryb3kiLCJwYXJlbnQiLCJjaG9vc2VGcm9tVGhyZWUiLCJjZCIsImZpbmQiLCJnZXRDb21wb25lbnQiLCJub3dQbGF5ZXIiLCJpIiwiY29uc29sZSIsImxvZyIsImoiLCJpbmRleCIsIm5vd1Byb3BlcnR5IiwiZXZlbnRBY3Rpb24iLCJyYW5kX2V2ZW50Iiwibm90ZSIsIk5vZGUiLCJhZGRDb21wb25lbnQiLCJTcHJpdGUiLCJzZWxmIiwiZXZlbnRfbmFtZSIsInVzZUNhcmRFbmFibGVkIiwiZ29FbmFibGVkIiwiYmxvb2QiLCJ0dXJuIiwibG9hZGVyIiwibG9hZFJlcyIsIlNwcml0ZUZyYW1lIiwiZXJyIiwic3ByaXRlRnJhbWUiLCJzcGVjaWFsSnVkZ2UiLCJyb2xlIiwiaGF2ZU1pbmUiLCJleHBvc2VkIiwibWluZUF0dGFjayIsImlzRGVhZCIsImJ1ZmYiLCJ0b2RvTGlzdCIsImVuZFR1cm4iLCJub3dUdXJuIiwicGVyc29uIiwiYWN0Iiwic3RlcE9uQ2VsbCIsInJhbmRfdmFsIiwib25Mb2FkIiwic3RhcnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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RCxFQUFFLENBQUM2RCxXQUE1QixFQUF5QyxVQUFVQyxHQUFWLEVBQWVDLFdBQWYsRUFBNEI7QUFDcEVWLFFBQUFBLElBQUksQ0FBQzNDLElBQUwsQ0FBVTZCLFlBQVYsQ0FBdUJ2QyxFQUFFLENBQUNvRCxNQUExQixFQUFrQ1csV0FBbEMsR0FBZ0RBLFdBQWhEO0FBQ0EsT0FGRDtBQUdBLEtBSkksTUFLQTtBQUFFO0FBQ04vRCxNQUFBQSxFQUFFLENBQUMyRCxNQUFILENBQVVDLE9BQVYsQ0FBa0IsS0FBbEIsRUFBeUI1RCxFQUFFLENBQUM2RCxXQUE1QixFQUF5QyxVQUFVQyxHQUFWLEVBQWVDLFdBQWYsRUFBNEI7QUFDcEVWLFFBQUFBLElBQUksQ0FBQzNDLElBQUwsQ0FBVTZCLFlBQVYsQ0FBdUJ2QyxFQUFFLENBQUNvRCxNQUExQixFQUFrQ1csV0FBbEMsR0FBZ0RBLFdBQWhEO0FBQ0EsT0FGRDtBQUdBO0FBQ0UsR0F6TUksQ0EyTUw7O0FBM01LLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIi8vIExlYXJuIGNjLkNsYXNzOlxuLy8gIC0gaHR0cHM6Ly9kb2NzLmNvY29zLmNvbS9jcmVhdG9yL21hbnVhbC9lbi9zY3JpcHRpbmcvY2xhc3MuaHRtbFxuLy8gTGVhcm4gQXR0cmlidXRlOlxuLy8gIC0gaHR0cHM6Ly9kb2NzLmNvY29zLmNvbS9jcmVhdG9yL21hbnVhbC9lbi9zY3JpcHRpbmcvcmVmZXJlbmNlL2F0dHJpYnV0ZXMuaHRtbFxuLy8gTGVhcm4gbGlmZS1jeWNsZSBjYWxsYmFja3M6XG4vLyAgLSBodHRwczovL2RvY3MuY29jb3MuY29tL2NyZWF0b3IvbWFudWFsL2VuL3NjcmlwdGluZy9saWZlLWN5Y2xlLWNhbGxiYWNrcy5odG1sXG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG5cdFx0bWFweDogMCwgLy/lnKhtYXBbaV1bal3kuK3nmoTmqKrlnZDmoIdcblx0XHRtYXB5OiAwLC8v5ZyobWFwW2ldW2pd5Lit55qE57q15Z2Q5qCHXG5cdFx0a2luZDogbnVsbCwgLy/moLzlrZDnmoTnsbvlnovvvIwwOuepuueZveagvO+8jDE65Y2h54mM5qC877yMMjrkuovku7bmoLxcblx0XHRpbk1vbml0b3I6IDAsIC8v55So5p2l5Yik5pat5piv5ZCm5aSE5LqO55uR5ZCs5Lit55qE5qCH6K6wXG5cdFx0cm91dGVJRDogbnVsbCwgLy/orrDlvZXov5nkuKpjZWxs5pivbWFw5Lit5ZOq5p2hcm91dGXnmoTnu4jngrnvvIzljbPlnKhyb3V0ZXPkuK3nmoTkuIvmoIdcblx0XHRcbiAgICB9LFxuXHRcblx0c2V0Q29sb3I6IGZ1bmN0aW9uKCkge1xuXHRcdC8v6K6+572uY2VsbOeahOminOiJsuS4uue7v+iJsu+8jOihqOekuuWPr+i1sFxuXHRcdHRoaXMubm9kZS5jb2xvciA9IGNjLmNvbG9yKDEwMiwyNTUsMTAyLDI1NSk7XG5cdH0sXG5cdFxuXHRyZXNldENvbG9yOiBmdW5jdGlvbigpIHtcblx0XHQvL+i/mOWOn2NlbGznmoTpopzoibJcblx0XHR0aGlzLm5vZGUuY29sb3IgPSBjYy5jb2xvcigyNTUsMjU1LDI1NSwyNTUpO1xuXHR9LFxuXHRcblx0Z2V0T25lQ2FyZDogZnVuY3Rpb24ocGVyc29uX2pzLCBjYXJkTmFtZSwgdG90Q2FyZE51bSkge1xuXHRcdC8v6ZqP5py66I635b6XMeW8oOeJjFxuXHRcdHZhciBjYXJkSUQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqdG90Q2FyZE51bSk7XG5cdFx0cGVyc29uX2pzLmNhcmRzLnB1c2goY2FyZElEKTtcblx0XHRpZiAocGVyc29uX2pzLm5vZGUubmFtZSA9PSAnUGVyc29uMScpIHtcblx0XHQvL+WIm+W7uueUqOadpeaPkOekuuiOt+W+l+WNoeeJjOeahOeyvueBteiKgueCuVxuXHRcdFx0dmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh3aW5kb3cuZ2xvYmFsLmNhcmRub2RlW2NhcmRJRF0pO1xuXHRcdFx0bm9kZS5zZXRQb3NpdGlvbigwLCAwKTtcblx0XHRcdC8v5byA5ZCvbm90ZeiKgueCueeahOebkeWQrO+8jOeCueWHu+WQjua2iOWksVxuXHRcdFx0bm9kZS5tc2cgPSAn6I635b6X5Y2h54mMOicrY2FyZE5hbWVbY2FyZElEXTtcblx0XHRcdG5vZGUub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uICggZXZlbnQgKSB7XG5cdFx0XHRcdGNjLmdhbWUuZW1pdCgnc3RlcE9uQ2VsbC1kb25lJywgdGhpcy5tc2cpO1xuXHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdH0sIG5vZGUpO1xuXHRcdFx0bm9kZS5wYXJlbnQgPSB0aGlzLm5vZGUucGFyZW50LnBhcmVudDtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdFx0Y2MuZ2FtZS5lbWl0KCdzdGVwT25DZWxsLWRvbmUnLCAn6I635b6X5Y2h54mMOicrY2FyZE5hbWVbY2FyZElEXSk7XG5cdH0sXG5cdFxuXHRjaG9vc2VGcm9tVGhyZWU6IGZ1bmN0aW9uKGNhcmROYW1lLCB0b3RDYXJkTnVtKSB7XG5cdFx0dmFyIGNkID0gW107XG5cdFx0Y2RbMF0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqdG90Q2FyZE51bSk7XG5cdFx0Y2RbMV0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqdG90Q2FyZE51bSk7XG5cdFx0Y2RbMl0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqdG90Q2FyZE51bSk7XG5cdFx0XG5cdFx0aWYgKGNjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnZ2xvYmFsR2FtZScpLm5vd1BsYXllci5uYW1lID09ICdQZXJzb24xJykge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHtcblx0XHRcdFx0dmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh3aW5kb3cuZ2xvYmFsLmNhcmRub2RlW2NkW2ldXSk7XG5cdFx0XHRcdG5vZGUubmFtZSA9ICdjaG9vc2VGcm9tVGhyZWUnK2k7XG5cdFx0XHRcdG5vZGUuc2V0UG9zaXRpb24oLTUwMCs1MDAqaSwgMCk7XG5cdFx0XHRcdG5vZGUuY2FyZElEID0gY2RbaV07XG5cdFx0XHRcdG5vZGUubXNnID0gJ+iOt+W+l+WNoeeJjDonK2NhcmROYW1lW2NkW2ldXTtcblx0XHRcdFx0bm9kZS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0XHR2YXIgcGVyc29uX2pzID0gY2MuZmluZCgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdnbG9iYWxHYW1lJykubm93UGxheWVyLmdldENvbXBvbmVudCgnUGVyc29uJyk7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ+W+l+WIsOWNoeeJjDonK3RoaXMuY2FyZElEKTtcblx0XHRcdFx0XHRwZXJzb25fanMuY2FyZHMucHVzaCh0aGlzLmNhcmRJRCk7XG5cdFx0XHRcdFx0Y2MuZ2FtZS5lbWl0KCdzdGVwT25DZWxsLWRvbmUnLCB0aGlzLm1zZyk7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCAzOyBqKyspIHtcblx0XHRcdFx0XHRcdGNjLmZpbmQoJ0NhbnZhcy9jaG9vc2VGcm9tVGhyZWUnK2opLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIG5vZGUpXG5cdFx0XHRcdG5vZGUucGFyZW50ID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dmFyIGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjMpO1xuXHRcdFx0Y2MuZmluZCgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdnbG9iYWxHYW1lJykubm93UHJvcGVydHkuY2FyZHMucHVzaChjZFtpbmRleF0pO1xuXHRcdFx0Y2MuZ2FtZS5lbWl0KCdzdGVwT25DZWxsLWRvbmUnLCAn6I635b6X5Y2h54mMOicrY2FyZE5hbWVbY2RbaW5kZXhdXSk7XG5cdFx0fVxuXHR9LFxuXHRcblx0ZXZlbnRBY3Rpb246IGZ1bmN0aW9uKHBlcnNvbl9qcykge1xuXHRcdC8v6ZqP5py65Lqn55SfNuS4quS6i+S7tuS5i+S4gFxuXHRcdHZhciByYW5kX2V2ZW50ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjYpO1xuXHRcdC8v5Yib5bu655So5p2l5o+Q56S66I635b6X6Kem5Y+R5LqL5Lu255qE57K+54G16IqC54K5XG5cdFx0dmFyIG5vdGUgPSBuZXcgY2MuTm9kZSgpO1xuXHRcdG5vdGUuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7XG5cdFx0bm90ZS5zZXRQb3NpdGlvbigwLCAwKTtcblx0XHRub3RlLnBhcmVudCA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50O1xuXHRcdHZhciBzZWxmID0gbm90ZSwgZXZlbnRfbmFtZTtcblx0XHRpZiAocmFuZF9ldmVudCA9PSAwKSB7IC8v6Zm36ZixXG5cdFx0XHRldmVudF9uYW1lID0gXCLpmbfpmLFcIjtcblx0XHRcdHBlcnNvbl9qcy51c2VDYXJkRW5hYmxlZCA9IDA7IC8v5pys5Zue5ZCI5LiN5Y+v5L2/55So5Y2h54mMLOS4i+WbnuWQiOe9rjFcblx0XHRcdC8vd2FybmluZzog5LiL5Zue5ZCI6K6w5b6X5pS55Y+YXG5cdFx0fVxuXHRcdGVsc2UgaWYgKHJhbmRfZXZlbnQgPT0gMSkgeyAvL+ebkeeLsVxuXHRcdFx0ZXZlbnRfbmFtZSA9IFwi55uR54uxXCI7IC8v5LiL5Zue5ZCI5LiN5Y+v6LWwXG5cdFx0XHRwZXJzb25fanMuZ29FbmFibGVkID0gMDtcblx0XHRcdC8vd2FybmluZzog5LiL5Zue5ZCI6K6w5b6X5pS55Y+YXG5cdFx0fVxuXHRcdGVsc2UgaWYgKHJhbmRfZXZlbnQgPT0gMikgeyAvL+aBtumtlFxuXHRcdFx0ZXZlbnRfbmFtZSA9IFwi5oG26a2UXCI7ICAvL+aNn+WkseS4gOa7tOihgOmHj1xuXHRcdFx0cGVyc29uX2pzLmJsb29kLS07XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHJhbmRfZXZlbnQgPT0gMykgeyAvL+WlpeWIqee7mVxuXHRcdFx0ZXZlbnRfbmFtZSA9IFwi5aWl5Yip57uZXCI7XG5cdFx0XHRwZXJzb25fanMudHVybisrOyAvL+iOt+W+l+WbnuWQiFxuXHRcdH1cblx0XHRlbHNlIGlmIChyYW5kX2V2ZW50ID09IDQpIHsgLy/op4bph45cblx0XHRcdGV2ZW50X25hbWUgPSBcIuinhumHjlwiOyAgLy90byBkb1xuXHRcdH1cblx0XHRlbHNlIGlmIChyYW5kX2V2ZW50ID09IDUpIHsgLy/lpKnkvb9cblx0XHRcdGV2ZW50X25hbWUgPSBcIuWkqeS9v1wiO1xuXHRcdFx0cGVyc29uX2pzLmJsb29kID0gTWF0aC5mbG9vcihwZXJzb25fanMuYmxvb2QqMS41KTtcblx0XHR9XG5cdFx0aWYgKHBlcnNvbl9qcy5ub2RlLm5hbWUgPT0gJ1BlcnNvbjEnKSB7XG5cdFx0XHRjYy5sb2FkZXIubG9hZFJlcygn5LqL5Lu25Zu+54mHLycrZXZlbnRfbmFtZSwgY2MuU3ByaXRlRnJhbWUsIGZ1bmN0aW9uIChlcnIsIHNwcml0ZUZyYW1lKSB7XG5cdFx0XHRcdHNlbGYuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcblx0XHRcdH0pO1xuXHRcdFx0Ly/lvIDlkK9ub3Rl6IqC54K555qE55uR5ZCs77yM54K55Ye75ZCO5raI5aSxXG5cdFx0XHRub3RlLm1zZyA9ICfop6blj5Hkuovku7Y6JytldmVudF9uYW1lO1xuXHRcdFx0bm90ZS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24gKCBldmVudCApIHtcblx0XHRcdFx0Y2MuZ2FtZS5lbWl0KCdzdGVwT25DZWxsLWRvbmUnLCB0aGlzLm1zZyk7XG5cdFx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdFx0XHRcblx0XHRcdH0sIG5vdGUpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0XHRjYy5nYW1lLmVtaXQoJ3N0ZXBPbkNlbGwtZG9uZScsICfop6blj5Hkuovku7Y6JytldmVudF9uYW1lKTtcblx0fSxcblx0XG5cdHNwZWNpYWxKdWRnZTogZnVuY3Rpb24ocm9sZSkge1xuXHRcdGlmICh0aGlzLmhhdmVNaW5lID09IDEpIHtcblx0XHRcdHJvbGUuZXhwb3NlZCA9IDE7XG5cdFx0XHRyb2xlLmJsb29kIC09IHRoaXMubWluZUF0dGFjaztcblx0XHRcdGlmIChyb2xlLmJsb29kIDw9IDApXG5cdFx0XHRcdHJvbGUuaXNEZWFkID0gMTtcblx0XHRcdGNvbnNvbGUubG9nKCcqKioqJywgdGhpcy5taW5lQXR0YWNrKTtcblx0XHRcdHZhciBidWZmPWNjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnQnVmZicpO1xuXHRcdFx0YnVmZi50b2RvTGlzdC5wdXNoKHtcblx0XHRcdFx0ZW5kVHVybjp3aW5kb3cuZ2xvYmFsLm5vd1R1cm4rMSxcblx0XHRcdFx0cGVyc29uOnJvbGUsXG5cdFx0XHRcdGFjdDpmdW5jdGlvbigpe1xuXHRcdFx0XHRcdGlmICh0aGlzLnBlcnNvbiAhPSBjYy5maW5kKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ2dsb2JhbEdhbWUnKS5ub3dQcm9wZXJ0eSlcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR0aGlzLnBlcnNvbi5leHBvc2VkID0gMDtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdHRoaXMuaGF2ZU1pbmUgPSAwO1xuXHRcdH1cblx0fSxcblx0XG5cdHN0ZXBPbkNlbGw6IGZ1bmN0aW9uKHBlcnNvbikge1xuXHRcdFxuXHRcdC8v6I635Y+WcGVyc29u6IqC54K555qE57uE5Lu2XG5cdFx0dmFyIHBlcnNvbl9qcyA9IHBlcnNvbi5nZXRDb21wb25lbnQoJ1BlcnNvbicpO1xuXHRcdFxuXHRcdHRoaXMuc3BlY2lhbEp1ZGdlKHBlcnNvbl9qcyk7XG5cdFx0XG5cdFx0aWYgKHRoaXMua2luZCA9PSAwKSB7Ly/nqbrnmb3moLxcblx0XHRcdGNjLmdhbWUuZW1pdCgnc3RlcE9uQ2VsbC1kb25lJywgJycpOyAvL+WPkemAgeepuuS4slxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0aGlzLmtpbmQgPT0gMSkgey8v5Y2h54mM5qC8XG5cdFx0XHR2YXIgY2FyZE5hbWUgPSBbJ+eCuOW8uScsJ+eyvuWHhuWvvOW8uScsJ+WcsOmbtycsJ+W6h+aKpCcsJ+WkqeS9v+eahOW6h+aKpCcsJ+aImOelnueahOelneemjycsJ+iZmuW8sScsJ+WboumYn+eahOWKm+mHjycsXG5cdFx0XHRcdFx0XHRcdCfmsrvmhIgnLCflnKPlhYnmma7nhacnLCfmnJvov5zplZwnLCfnnLznnZsnLCfnjJvnlLfnmoTnpZ3npo8nLCfnm5flj5YnLCfmnZ/nvJonLCfov7fmg5EnLCfmi6/mlZEnXTtcblx0XHRcdHZhciB0b3RDYXJkTnVtID0gMTdcblx0XHRcdHZhciByYW5kX3ZhbCA9IE1hdGgucmFuZG9tKCk7XG5cdFx0XHRjb25zb2xlLmxvZygncmFuZF92YWwnK3JhbmRfdmFsKTtcblx0XHRcdGlmIChyYW5kX3ZhbCA8IDAuNSkgeyAvL+W+l+WIsOS4gOW8oOeJjFxuXHRcdFx0XHR0aGlzLmdldE9uZUNhcmQocGVyc29uX2pzLCBjYXJkTmFtZSwgdG90Q2FyZE51bSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNleyAvL+S4ieW8oOS4reaKveS4gOW8oFxuXHRcdFx0XHR0aGlzLmNob29zZUZyb21UaHJlZShjYXJkTmFtZSwgdG90Q2FyZE51bSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHRoaXMua2luZCA9PSAyKSB7IC8v5LqL5Lu25qC8XG5cdFx0XHR0aGlzLmV2ZW50QWN0aW9uKHBlcnNvbl9qcyk7IC8v5ZON5bqU5LqL5Lu2XG5cdFx0fVxuXHR9LFxuXHRcbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcblxuICAgIG9uTG9hZCAoKSB7XG5cdFx0XG5cdH0sXG5cbiAgICBzdGFydCAoKSB7XG5cdFx0Ly/orr7nva7moLzlrZDlm77niYdcblx0XHRcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0aWYgKHRoaXMua2luZCA9PSAwKSB7IC8v56m655m95qC8XG5cdFx0XHRjYy5sb2FkZXIubG9hZFJlcyhcImNlbGxcIiwgY2MuU3ByaXRlRnJhbWUsIGZ1bmN0aW9uIChlcnIsIHNwcml0ZUZyYW1lKSB7XG5cdFx0XHRcdHNlbGYubm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHRoaXMua2luZCA9PSAxKSB7IC8v5Y2h54mM5qC8XG5cdFx0XHRjYy5sb2FkZXIubG9hZFJlcyhcIuaKveWNoeagvFwiLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKGVyciwgc3ByaXRlRnJhbWUpIHtcblx0XHRcdFx0c2VsZi5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0ZWxzZSB7IC8v5LqL5Lu25qC8XG5cdFx0XHRjYy5sb2FkZXIubG9hZFJlcyhcIuS6i+S7tuagvFwiLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKGVyciwgc3ByaXRlRnJhbWUpIHtcblx0XHRcdFx0c2VsZi5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cdFx0XHR9KTtcblx0XHR9XG4gICAgfSxcblxuICAgIC8vIHVwZGF0ZSAoZHQpIHt9LFxufSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iXX0=