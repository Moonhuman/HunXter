{"version":3,"sources":["assets\\scripts\\Deck.js"],"names":["cc","Class","Component","properties","deck","Integer","role","showTips","news","tips","Node","addComponent","Label","label","getComponent","string","fontSize","enableBold","color","parent","find","choose_confirm","cardID","window","global","now_choosing_card","nowProperty","card","mobility","cardCost","cardFunction","closeCards","active","choose_cancel","cardDetail","node","instantiate","name","scaleX","scaleY","setPosition","closeDetail","destroy","removeCard","i","cards","length","splice","chooseCard","event","stopPropagation","showCards","isPlayCard","nowStep","cardnode","on","children","off","initDeck","nowPlayer","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        deck:[cc.Integer],\r\n        role: null,\r\n    },\r\n    \r\n    showTips:function(news){\r\n        var tips=new cc.Node();\r\n        tips.addComponent(cc.Label);\r\n        label=tips.getComponent(cc.Label);\r\n        label.string=news;\r\n        label.fontSize=50;\r\n        label.enableBold=true;\r\n        tips.color=cc.color(255,0,0,255);\r\n        tips.addComponent('Tips');\r\n        tips.parent=cc.find('Canvas');        \r\n    },\r\n    choose_confirm:function(){\r\n        var cardID=window.global.now_choosing_card;\r\n        var role=cc.find('Canvas').getComponent('globalGame').nowProperty;\r\n        var card=cc.find('Canvas/Card').getComponent('Card');\r\n        if (role.mobility<card.cardCost[cardID]){\r\n            cc.find('Canvas/Deck').getComponent('Deck').showTips(\"行动值不足！\");\r\n        }\r\n        else{\r\n            card.cardFunction[9](card);\r\n            cc.find('Canvas/Deck').getComponent('Deck').closeCards();\r\n        }\r\n        //关闭按钮\r\n\t\tcc.find('Canvas/choose_card_confirm').active=false;\r\n        cc.find('Canvas/choose_card_cancel').active=false;            \r\n    },\r\n\tchoose_cancel:function(){\r\n        //关闭按钮\r\n\t\tcc.find('Canvas/choose_card_confirm').active=false;\r\n        cc.find('Canvas/choose_card_cancel').active=false;        \r\n    },\r\n    cardDetail:function(){\r\n        var node=cc.instantiate(this);\r\n        node.name=\"card_detail\";\r\n        node.scaleX=0.8,node.scaleY=0.8;\r\n        node.setPosition(0,50);\r\n        node.parent=cc.find(\"Canvas\");\r\n        \r\n    },\r\n    closeDetail:function(){\r\n        var node=cc.find(\"Canvas/card_detail\");\r\n        if (node!=null)\r\n            node.destroy();\r\n    },\r\n    removeCard:function(cardID){\r\n        var role=cc.find('Canvas').getComponent('globalGame').nowProperty;\r\n        for (var i=0;i<role.cards.length;++i)\r\n            if (role.cards[i]==cardID){\r\n                role.cards.splice(i,1);\r\n                break;\r\n            }\r\n    },\r\n    chooseCard:function(event){\r\n        var deck=cc.find(\"Canvas/Deck\").getComponent(\"Deck\");\r\n        deck.closeDetail();\r\n        //显示确定/取消按钮\r\n\t\tcc.find('Canvas/choose_card_confirm').active=true;\r\n        cc.find('Canvas/choose_card_cancel').active=true;\r\n        //重置当前选择的手牌\r\n        window.global.now_choosing_card=this.cardID;\r\n        event.stopPropagation();\r\n    },\t\r\n    showCards:function(){\r\n        var isPlayCard=(cc.find(\"Canvas\").getComponent(\"globalGame\").nowStep==3);\r\n        for (var i=0;i<this.deck.length;++i){\r\n            var cardID=this.deck[i];\r\n            var node=cc.instantiate(window.global.cardnode[cardID]);\r\n            node.scaleX=0.4,node.scaleY=0.4;\r\n            node.setPosition(200+i*200,0);\r\n            node.cardID=cardID;\r\n            node.parent=this.node;\r\n            node.on(\"mouseenter\",this.cardDetail,node);\r\n            node.on(\"mouseleave\",this.closeDetail,node);\r\n\t\t\tif (isPlayCard==true){\r\n\t\t\t    node.on(\"mousedown\",this.chooseCard,node);\r\n\t\t\t}\r\n        }\r\n    },\r\n\tcloseCards:function(){\r\n\t\tvar children=cc.find(\"Canvas/Deck\").children;\r\n\t\tfor (var i=0;i<children.length;++i)\r\n            children[i].destroy();\r\n        deck=cc.find('Canvas/Deck').getComponent('Deck');\r\n\t\tdeck.node.off(\"mousedown\",this.closeCards,deck);\r\n\t\tdeck.node.on(\"mousedown\",this.initDeck,deck);\r\n    },\r\n    initDeck:function(){\r\n\t\tthis.role=cc.find(\"Canvas\").getComponent(\"globalGame\").nowPlayer;\r\n\t\tthis.deck=this.role.getComponent(\"Person\").cards;\r\n        this.showCards();\r\n        this.node.off(\"mousedown\",this.initDeck,this);\r\n        this.node.on(\"mousedown\",this.closeCards,this);\r\n    },\r\n    onLoad () {\r\n        \r\n    },\r\n\r\n    start () {\r\n        this.node.on(\"mousedown\",this.initDeck,this);\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}