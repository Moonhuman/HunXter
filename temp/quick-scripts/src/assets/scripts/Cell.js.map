{"version":3,"sources":["assets\\scripts\\Cell.js"],"names":["cc","Class","Component","properties","mapx","mapy","kind","inMonitor","routeID","setColor","node","color","resetColor","getOneCard","person_js","cardName","totCardNum","cardID","Math","floor","random","cards","push","name","instantiate","window","global","cardnode","setPosition","msg","on","event","game","emit","destroy","parent","chooseFromThree","cd","find","getComponent","nowPlayer","i","console","log","j","index","nowProperty","eventAction","rand_event","note","Node","addComponent","Sprite","self","event_name","useCardEnabled","goEnabled","blood","turn","loader","loadRes","SpriteFrame","err","spriteFrame","specialJudge","role","haveMine","exposed","mineAttack","isDead","buff","todoList","endTurn","nowTurn","person","act","stepOnCell","rand_val","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\t\tmapx: 0, //在map[i][j]中的横坐标\n\t\tmapy: 0,//在map[i][j]中的纵坐标\n\t\tkind: null, //格子的类型，0:空白格，1:卡牌格，2:事件格\n\t\tinMonitor: 0, //用来判断是否处于监听中的标记\n\t\trouteID: null, //记录这个cell是map中哪条route的终点，即在routes中的下标\n\t\t\n    },\n\t\n\tsetColor: function() {\n\t\t//设置cell的颜色为绿色，表示可走\n\t\tthis.node.color = cc.color(102,255,102,255);\n\t},\n\t\n\tresetColor: function() {\n\t\t//还原cell的颜色\n\t\tthis.node.color = cc.color(255,255,255,255);\n\t},\n\t\n\tgetOneCard: function(person_js, cardName, totCardNum) {\n\t\t//随机获得1张牌\n\t\tvar cardID = Math.floor(Math.random()*totCardNum);\n\t\tperson_js.cards.push(cardID);\n\t\tif (person_js.node.name == 'Person1') {\n\t\t//创建用来提示获得卡牌的精灵节点\n\t\t\tvar node = cc.instantiate(window.global.cardnode[cardID]);\n\t\t\tnode.setPosition(0, 0);\n\t\t\t//开启note节点的监听，点击后消失\n\t\t\tnode.msg = '获得卡牌:'+cardName[cardID];\n\t\t\tnode.on('mousedown', function ( event ) {\n\t\t\t\tcc.game.emit('stepOnCell-done', this.msg);\n\t\t\t\tthis.destroy();\n\t\t\t}, node);\n\t\t\tnode.parent = this.node.parent.parent;\n\t\t}\n\t\telse\n\t\t\tcc.game.emit('stepOnCell-done', '获得卡牌:'+cardName[cardID]);\n\t},\n\t\n\tchooseFromThree: function(cardName, totCardNum) {\n\t\tvar cd = [];\n\t\tcd[0] = Math.floor(Math.random()*totCardNum);\n\t\tcd[1] = Math.floor(Math.random()*totCardNum);\n\t\tcd[2] = Math.floor(Math.random()*totCardNum);\n\t\t\n\t\tif (cc.find('Canvas').getComponent('globalGame').nowPlayer.name == 'Person1') {\n\t\t\tfor (var i = 0; i < 3; i++) {\n\t\t\t\tvar node = cc.instantiate(window.global.cardnode[cd[i]]);\n\t\t\t\tnode.name = 'chooseFromThree'+i;\n\t\t\t\tnode.setPosition(-500+500*i, 0);\n\t\t\t\tnode.cardID = cd[i];\n\t\t\t\tnode.msg = '获得卡牌:'+cardName[cd[i]];\n\t\t\t\tnode.on('mousedown', function(event) {\n\t\t\t\t\tvar person_js = cc.find('Canvas').getComponent('globalGame').nowPlayer.getComponent('Person');\n\t\t\t\t\tconsole.log('得到卡牌:'+this.cardID);\n\t\t\t\t\tperson_js.cards.push(this.cardID);\n\t\t\t\t\tcc.game.emit('stepOnCell-done', this.msg);\n\t\t\t\t\tfor (var j = 0; j < 3; j++) {\n\t\t\t\t\t\tcc.find('Canvas/chooseFromThree'+j).destroy();\n\t\t\t\t\t}\n\t\t\t\t}, node)\n\t\t\t\tnode.parent = this.node.parent.parent;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvar index = Math.floor(Math.random()*3);\n\t\t\tcc.find('Canvas').getComponent('globalGame').nowProperty.cards.push(cd[index]);\n\t\t\tcc.game.emit('stepOnCell-done', '获得卡牌:'+cardName[cd[index]]);\n\t\t}\n\t},\n\t\n\teventAction: function(person_js) {\n\t\t//随机产生6个事件之一\n\t\tvar rand_event = Math.floor(Math.random()*6);\n\t\t//创建用来提示获得触发事件的精灵节点\n\t\tvar note = new cc.Node();\n\t\tnote.addComponent(cc.Sprite);\n\t\tnote.setPosition(0, 0);\n\t\tnote.parent = this.node.parent.parent;\n\t\tvar self = note, event_name;\n\t\tif (rand_event == 0) { //陷阱\n\t\t\tevent_name = \"陷阱\";\n\t\t\tperson_js.useCardEnabled = 0; //本回合不可使用卡牌,下回合置1\n\t\t\t//warning: 下回合记得改变\n\t\t}\n\t\telse if (rand_event == 1) { //监狱\n\t\t\tevent_name = \"监狱\"; //下回合不可走\n\t\t\tperson_js.goEnabled = 0;\n\t\t\t//warning: 下回合记得改变\n\t\t}\n\t\telse if (rand_event == 2) { //恶魔\n\t\t\tevent_name = \"恶魔\";  //损失一滴血量\n\t\t\tperson_js.blood--;\n\t\t}\n\t\telse if (rand_event == 3) { //奥利给\n\t\t\tevent_name = \"奥利给\";\n\t\t\tperson_js.turn++; //获得回合\n\t\t}\n\t\telse if (rand_event == 4) { //视野\n\t\t\tevent_name = \"视野\";  //to do\n\t\t}\n\t\telse if (rand_event == 5) { //天使\n\t\t\tevent_name = \"天使\";\n\t\t\tperson_js.blood = Math.floor(person_js.blood*1.5);\n\t\t}\n\t\tif (person_js.node.name == 'Person1') {\n\t\t\tcc.loader.loadRes('事件图片/'+event_name, cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t\t//开启note节点的监听，点击后消失\n\t\t\tnote.msg = '触发事件:'+event_name;\n\t\t\tnote.on('mousedown', function ( event ) {\n\t\t\t\tcc.game.emit('stepOnCell-done', this.msg);\n\t\t\t\tthis.destroy();\n\t\t\t\t\n\t\t\t}, note);\n\t\t}\n\t\telse\n\t\t\tcc.game.emit('stepOnCell-done', '触发事件:'+event_name);\n\t},\n\t\n\tspecialJudge: function(role) {\n\t\tif (this.haveMine == 1) {\n\t\t\trole.exposed = 1;\n\t\t\trole.blood -= this.mineAttack;\n\t\t\tif (role.blood <= 0)\n\t\t\t\trole.isDead = 1;\n\t\t\tconsole.log('****', this.mineAttack);\n\t\t\tvar buff=cc.find('Canvas').getComponent('Buff');\n\t\t\tbuff.todoList.push({\n\t\t\t\tendTurn:window.global.nowTurn+1,\n\t\t\t\tperson:role,\n\t\t\t\tact:function(){\n\t\t\t\t\tif (this.person != cc.find('Canvas').getComponent('globalGame').nowProperty)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tthis.person.exposed = 0;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.haveMine = 0;\n\t\t}\n\t},\n\t\n\tstepOnCell: function(person) {\n\t\t\n\t\t//获取person节点的组件\n\t\tvar person_js = person.getComponent('Person');\n\t\t\n\t\tthis.specialJudge(person_js);\n\t\t\n\t\tif (this.kind == 0) {//空白格\n\t\t\tcc.game.emit('stepOnCell-done', ''); //发送空串\n\t\t\treturn;\n\t\t}\n\t\telse if (this.kind == 1) {//卡牌格\n\t\t\tvar cardName = ['炸弹','精准导弹','地雷','庇护','天使的庇护','战神的祝福','虚弱','团队的力量',\n\t\t\t\t\t\t\t'治愈','圣光普照','望远镜','眼睛','猛男的祝福','盗取','束缚','迷惑','拯救'];\n\t\t\tvar totCardNum = 17\n\t\t\tvar rand_val = Math.random();\n\t\t\tconsole.log('rand_val'+rand_val);\n\t\t\tif (rand_val < 0.5) { //得到一张牌\n\t\t\t\tthis.getOneCard(person_js, cardName, totCardNum);\n\t\t\t}\n\t\t\telse{ //三张中抽一张\n\t\t\t\tthis.chooseFromThree(cardName, totCardNum);\n\t\t\t}\n\t\t}\n\t\telse if (this.kind == 2) { //事件格\n\t\t\tthis.eventAction(person_js); //响应事件\n\t\t}\n\t},\n\t\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n\t\t\n\t},\n\n    start () {\n\t\t//设置格子图片\n\t\t\n\t\tvar self = this;\n\t\tif (this.kind == 0) { //空白格\n\t\t\tcc.loader.loadRes(\"cell\", cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t}\n\t\telse if (this.kind == 1) { //卡牌格\n\t\t\tcc.loader.loadRes(\"抽卡格\", cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t}\n\t\telse { //事件格\n\t\t\tcc.loader.loadRes(\"事件格\", cc.SpriteFrame, function (err, spriteFrame) {\n\t\t\t\tself.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n\t\t\t});\n\t\t}\n    },\n\n    // update (dt) {},\n});\n\n\n\n\n\n\n\n\n\n\n\n\n"]}