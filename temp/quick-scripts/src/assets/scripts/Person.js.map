{"version":3,"sources":["assets\\scripts\\Person.js"],"names":["global","require","person","cc","Class","Component","properties","nickname","get","ID","position","attack","blood","mobility","cards","myStatus","turn","useCardEnabled","goEnabled","_goEnabled","isDead","shield","halfShield","sight","eyes","parter","avatar","posX","posY","moveByRoute","route","p","tween","i","length","to","v2","x","y","tmp","Array","push","getComponent","mapx","mapy","find","nowProperty","call","Positionchecked","node","stepOnCell","start","move2Pos","mapObj","pos","map","getPosition","setPosition","bindAvatar","onLoad","window","persons","console","log","name","update","dt","nowPerson","Math","round"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\nvar global=require('globalGame');\nvar person=cc.Class({\n    extends: cc.Component,\n\n    properties: {\n\t\tnickname: {\n\t\t\tdefault:null,\n\t\t\tget: function () {\n\t\t\t\treturn this.nickname;\n\t\t\t},\n\t\t}\t,\n\t\tID:null,\n\t\tposition:null,\n\t\tattack:1,\n\t\tblood:10,//玩家血量,初始为2点，每回合恢复2点\n\t\tmobility:2,//玩家行动值\n\t\tcards:null,\n\t\tmyStatus:1,//0为死亡，1为正常\n\t\tturn:1,//玩家回合数\n\t\tuseCardEnabled:1,//是否使用卡牌，1为可使用卡牌\n\t\tgoEnabled:{\n\t\t\tdefault:1,\n\t\t\tget: function () {\n\t\t\t\treturn this._goEnabled;\n\t\t\t},\n\t\t},//是否可以行走,1为可以行走\n\t\tisDead:0,//是否已阵亡，0：活着，1：死了\n\t\tshield:0,//可免疫一次伤害的护盾，0: 无, 1: 有\n\t\thalfShield:0,//可减半一次伤害的护盾，可累积次数\n\t\tsight:2,//视野大小，默认值为2\n\t\teyes:null,\n\t\tparter:null,\n\t\tavatar:null,\n\t\tposX:null,\n\t\tposY:null,\n    },\n\tmoveByRoute:function(route){\n\t\t//声明一个动作序列\n\t\t//var r=[cc.v2(100,100),cc.v2(100,100),cc.v2(100,100),cc.v2(100,100)];\n\t\t//var actArr=new Array();\n\t\t//console.log(route);\n\t\tvar p=cc.tween(this.avatar);\n\t\tfor (var i=0;i<route.length-1;i++){\n\t\t\tp.to(0.2,{position:cc.v2(route[i].x,route[i].y)});\n\t\t\tvar tmp = new Array();\n\t\t\ttmp.push(route[i].getComponent('Cell').mapx);\n\t\t\ttmp.push(route[i].getComponent('Cell').mapy);\n\t\t\ttmp.push(cc.find('Canvas').getComponent('globalGame').nowProperty);\n\t\t\tp.call( function() {\n\t\t\t\tthis[2].posX=this[0];\n\t\t\t\tthis[2].posY=this[1];\n\t\t\t}, tmp);\n\t\t\tPositionchecked(route[i].x,route[i].y,this.node);\n\t\t\t//console.log(route[i].getComponent('Cell').mapx+','+route[i].getComponent('Cell').mapy);\n\t\t}\n\t\tp.to(0.2,{position:cc.v2(route[route.length-1].x,route[route.length-1].y)});\n\t\tvar tmp = new Array();\n\t\ttmp.push(route[route.length-1].getComponent('Cell').mapx);\n\t\ttmp.push(route[route.length-1].getComponent('Cell').mapy);\n\t\ttmp.push(cc.find('Canvas').getComponent('globalGame').nowProperty);\n\t\ttmp.push(route[route.length-1]);\n\t\tp.call(function(){\n\t\t\tthis[2].posX=this[0];\n\t\t\tthis[2].posY=this[1];\n\t\t\tthis[3].getComponent('Cell').stepOnCell(this[2].node);\n\t\t},tmp);\n\t\tp.start();\n\t\t//this.avatar.setPosition(route[route.length-1].getPosition());\n\t\t\n\t\t\n\t\t\n\t\n\t},\n\tmove2Pos:function(x,y){\n\t\tthis.posX=x;\n\t\tthis.posY=y;\n\t\t//this.nowPos.y=y;\n\t\tvar mapObj=cc.find('Canvas/map').getComponent('GetMap');\n\t\tvar pos=mapObj.map[x][y].getPosition();\n\t\tthis.avatar.setPosition(pos);\n\t\t//console.log(pos);\n\t\t//console.log(this.nowPos);\n\t},\n\tbindAvatar:function(node){\n\t\t//console.log(node);\n\t\tthis.avatar=node;\n\t},\n\tonLoad(){\t\n\t\tthis.cards=new Array();\n\t\tthis.eyes=new Array();\n\t\twindow.global.persons.push(this.node);\n\t\tconsole.log(this.name+\"onLoad\");\n\t},\n    start () {\n\t\t//初始化任务\n\t\t\n    },\n    update (dt) {\n\t\t\n\t\t\n\t},\n});\n\nfunction Positionchecked(x,y,nowPerson){\n\t//一次遍历人物列表上位置，检查是否有其他人，有则计算伤害。\n\tvar persons=window.global.persons;\n\tfor (var i=0;i<persons.length;i++){\n\t\tif (nowPerson!=persons[i] && x==persons[i].posX &&  y==persons[i].posY){\n\t\t\t//计算伤害\n\t\t\tif (persons[i].isDead==1)//当前位置玩家已死亡,不需要计算伤害\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar attack=persons[i].attack;\n\t\t\tif (nowPerson.shield==1){\n\t\t\t\tattack= 0;\n\t\t\t}\n\t\t\telse if (nowPerson.halfShield>0){\n\t\t\t\tnowPerson.halfShield-=1;\n\t\t\t\tattack= Math.round(attack/2);//四舍五入\n\t\t\t}\n\t\t\tnowPerson.blood-=attack;\n\t\t}\n\t}\n}"]}